<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Arcane Games</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --color-bg: #0A091E;
            --accent-1: #F08080;
            --accent-2: #40E0D0;
            --text-light: #F5F5F5;
            --text-muted: #A0A0A0;
        }

        body {
            font-family: 'Inter', 'Segoe UI', 'Arial', sans-serif;
            background: var(--color-bg);
            color: var(--text-light);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            font-weight: 400;
            line-height: 1.6;
        }

        /* Remove heavy animations for performance */
        body::before {
            display: none;
        }

        .admin-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        /* Modern Dashboard Header - Simplified */
        .admin-header {
            background: var(--color-bg);
            border: 1px solid rgba(64, 224, 208, 0.2);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left h1 {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-2);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
            line-height: 1.2;
        }

        .header-left h1 i {
            color: var(--accent-2);
        }

        .header-left p {
            font-size: 0.95rem;
            color: var(--text-muted);
            font-weight: 400;
        }

        .header-stats {
            display: flex;
            gap: 30px;
        }

        .header-stat {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: var(--color-bg);
            border-radius: 8px;
            border: 1px solid rgba(64, 224, 208, 0.2);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            transition: background 0.2s ease;
        }

        .header-stat:hover {
            background: rgba(64, 224, 208, 0.1);
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .stat-icon.online {
            background: var(--accent-2);
            color: var(--color-bg);
        }

        .stat-icon.revenue {
            background: var(--accent-1);
            color: white;
        }

        .stat-icon.games {
            background: var(--accent-2);
            color: var(--color-bg);
        }

        .stat-info {
            display: flex;
            flex-direction: column;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-light);
            line-height: 1.2;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            font-weight: 500;
            text-transform: uppercase;
        }

        /* Dashboard Grid Layout */
        .dashboard-grid {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .metrics-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .metric-card {
            background: var(--color-bg);
            border: 1px solid rgba(64, 224, 208, 0.2);
            border-radius: 12px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            transition: background 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .metric-card:hover {
            background: rgba(64, 224, 208, 0.05);
        }

        .metric-card.primary {
            border-left: 4px solid var(--accent-2);
        }

        .metric-card.success {
            border-left: 4px solid var(--accent-2);
        }

        .metric-card.warning {
            border-left: 4px solid var(--accent-1);
        }

        .metric-card.info {
            border-left: 4px solid var(--accent-2);
        }

        .metric-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
        }

        .metric-card.primary .metric-icon {
            background: var(--accent-2);
            color: var(--color-bg);
        }

        .metric-card.success .metric-icon {
            background: var(--accent-2);
            color: var(--color-bg);
        }

        .metric-card.warning .metric-icon {
            background: var(--accent-1);
            color: white;
        }

        .metric-card.info .metric-icon {
            background: var(--accent-2);
            color: var(--color-bg);
        }

        .metric-content h3 {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-bottom: 8px;
            font-weight: 500;
            text-transform: uppercase;
            line-height: 1.3;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-light);
            margin-bottom: 6px;
            line-height: 1.1;
        }

        .metric-change {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .metric-change.positive {
            color: var(--accent-2);
        }

        .metric-change.negative {
            color: var(--accent-1);
        }

        .charts-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }

        .chart-card {
            background: var(--color-bg);
            border: 1px solid rgba(64, 224, 208, 0.2);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-header h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-light);
            display: flex;
            align-items: center;
            gap: 10px;
            line-height: 1.3;
        }

        .chart-header h3 i {
            color: var(--accent-2);
        }

        .chart-controls select {
            background: var(--color-bg);
            border: 1px solid rgba(64, 224, 208, 0.2);
            border-radius: 6px;
            padding: 8px 12px;
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .chart-container {
            height: 300px;
            position: relative;
            background: transparent;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .chart-container canvas {
            width: 100%;
            height: 100%;
            border-radius: 8px;
        }

        .realtime-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 25px;
        }

        .realtime-card {
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.9) 0%, rgba(25, 25, 50, 0.7) 100%);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 24px;
            padding: 28px;
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.4),
                0 8px 16px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-header h3 {
            font-size: 1.125rem;
            font-weight: 600;
            color: #ffffff;
            display: flex;
            align-items: center;
            gap: 12px;
            letter-spacing: -0.01em;
            line-height: 1.3;
        }

        .card-header h3 i {
            color: var(--accent-2);
        }

        .live-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.8rem;
            color: var(--accent-2);
            font-weight: 600;
        }

        .pulse {
            width: 8px;
            height: 8px;
            background: var(--accent-2);
            border-radius: 50%;
            /* Simplified - no animation for performance */
        }

        .management-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 25px;
        }

        .management-card {
            background: var(--color-bg);
            border: 1px solid rgba(64, 224, 208, 0.2);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .btn-primary {
            background: var(--accent-2);
            border: none;
            border-radius: 8px;
            padding: 10px 20px;
            color: var(--color-bg);
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .btn-primary:hover {
            background: rgba(64, 224, 208, 0.8);
        }

        /* Activity Feed Styles */
        .activity-feed {
            max-height: 300px;
            overflow-y: auto;
        }

        .activity-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            color: white;
        }

        .activity-icon.user {
            background: var(--accent-2);
            color: var(--color-bg);
        }

        .activity-icon.game {
            background: var(--accent-2);
            color: var(--color-bg);
        }

        .activity-icon.transaction {
            background: var(--accent-1);
            color: white;
        }

        .activity-icon.win {
            background: var(--accent-2);
            color: var(--color-bg);
        }

        .activity-content {
            flex: 1;
        }

        .activity-text {
            color: var(--text-light);
            font-size: 0.875rem;
            margin-bottom: 4px;
            font-weight: 500;
            line-height: 1.4;
        }

        .activity-time {
            color: var(--text-muted);
            font-size: 0.8rem;
            font-weight: 400;
            line-height: 1.3;
        }

        /* Geographic Stats Styles */
        .geo-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .geo-item:last-child {
            border-bottom: none;
        }

        .geo-flag {
            font-size: 1.5rem;
            width: 30px;
        }

        .geo-info {
            flex: 1;
        }

        .geo-country {
            color: var(--text-light);
            font-size: 0.875rem;
            font-weight: 500;
            display: block;
            margin-bottom: 6px;
            line-height: 1.3;
        }

        .geo-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
        }

        .geo-fill {
            height: 100%;
            background: var(--accent-2);
            border-radius: 3px;
            transition: width 0.2s ease;
        }

        .geo-percentage {
            color: var(--text-muted);
            font-size: 0.9rem;
            font-weight: 600;
            min-width: 40px;
            text-align: right;
        }

        /* Security Alerts Styles */
        .security-alerts {
            max-height: 300px;
            overflow-y: auto;
        }

        .alert-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .alert-item:last-child {
            border-bottom: none;
        }

        .alert-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        .alert-item.warning .alert-icon {
            background: rgba(240, 128, 128, 0.2);
            color: var(--accent-1);
        }

        .alert-item.info .alert-icon {
            background: rgba(64, 224, 208, 0.2);
            color: var(--accent-2);
        }

        .alert-item.success .alert-icon {
            background: rgba(64, 224, 208, 0.2);
            color: var(--accent-2);
        }

        .alert-content {
            flex: 1;
        }

        .alert-message {
            color: var(--text-light);
            font-size: 0.875rem;
            margin-bottom: 4px;
            font-weight: 500;
            line-height: 1.4;
        }

        .alert-time {
            color: var(--text-muted);
            font-size: 0.8rem;
            font-weight: 400;
            line-height: 1.3;
        }

        /* Management Stats Styles */
        .management-stats {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .management-stat {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .management-stat:last-child {
            border-bottom: none;
        }

        .management-stat .stat-label {
            color: var(--text-muted);
            font-size: 0.875rem;
            font-weight: 500;
            line-height: 1.3;
        }

        .management-stat .stat-value {
            color: var(--text-light);
            font-size: 1.125rem;
            font-weight: 600;
            line-height: 1.2;
        }

        /* Game Stats Styles */
        .game-stats {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .game-stat {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .game-stat:last-child {
            border-bottom: none;
        }

        .game-icon {
            font-size: 1.8rem;
            width: 40px;
            text-align: center;
        }

        .game-info {
            flex: 1;
        }

        .game-name {
            color: var(--text-light);
            font-size: 0.875rem;
            font-weight: 500;
            display: block;
            margin-bottom: 4px;
            line-height: 1.3;
        }

        .game-plays {
            color: var(--text-muted);
            font-size: 0.8rem;
            font-weight: 400;
            line-height: 1.3;
        }

        /* Report Links Styles */
        .report-links {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .report-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: var(--color-bg);
            border-radius: 8px;
            color: var(--text-light);
            text-decoration: none;
            transition: background 0.2s ease;
            border: 1px solid rgba(64, 224, 208, 0.2);
            font-weight: 500;
            line-height: 1.3;
        }

        .report-link:hover {
            background: rgba(64, 224, 208, 0.1);
        }

        .report-link i {
            color: var(--accent-2);
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .charts-row {
                grid-template-columns: 1fr;
            }
            
            .realtime-row {
                grid-template-columns: 1fr 1fr;
            }
            
            .management-row {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 20px;
            }
            
            .header-stats {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .metrics-row {
                grid-template-columns: 1fr 1fr;
            }
            
            .realtime-row {
                grid-template-columns: 1fr;
            }
            
            .management-row {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .metrics-row {
                grid-template-columns: 1fr;
            }
            
            .header-stats {
                flex-direction: column;
                width: 100%;
            }
        }

        .nav-btn {
            padding: 12px 20px;
            background: var(--color-bg);
            border: 1px solid rgba(64, 224, 208, 0.2);
            border-radius: 8px;
            color: var(--text-light);
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s ease;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .nav-btn i {
            font-size: 1rem;
            color: var(--accent-2);
        }

        .nav-btn:hover {
            background: rgba(64, 224, 208, 0.1);
        }

        .nav-btn.active {
            background: rgba(64, 224, 208, 0.15);
            border-color: var(--accent-2);
        }

        .nav-btn.active i {
            color: var(--accent-2);
        }

        .admin-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 32px;
            margin-top: 32px;
        }

        .admin-card {
            background: var(--color-bg);
            border: 1px solid rgba(64, 224, 208, 0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            transition: background 0.2s ease;
        }

        .admin-card:hover {
            background: rgba(64, 224, 208, 0.05);
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--accent-2);
            line-height: 1.2;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 28px;
            margin-bottom: 32px;
        }

        .stat-item {
            background: linear-gradient(135deg, rgba(20, 20, 40, 0.8) 0%, rgba(30, 30, 55, 0.6) 100%);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            padding: 28px;
            border-radius: 24px;
            text-align: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 12px 24px rgba(0, 0, 0, 0.3),
                0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .stat-item:hover {
            transform: translateY(-6px) scale(1.02);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.4),
                0 8px 16px rgba(255, 107, 157, 0.2);
            border-color: rgba(255, 255, 255, 0.12);
        }

        .stat-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent-2);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-light);
            margin-bottom: 8px;
            line-height: 1.1;
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.85rem;
            font-weight: 500;
            line-height: 1.3;
            text-transform: uppercase;
        }

        .user-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .user-list .activity-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 16px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.3s ease;
        }

        .user-list .activity-item:last-child {
            border-bottom: none;
        }

        .user-list .activity-item:hover {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 16px 12px;
            margin: 0 -12px;
        }

        .user-list .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            color: white;
            flex-shrink: 0;
        }

        .user-list .activity-icon i.fa-user-plus {
            background: linear-gradient(45deg, #3498db, #2980b9);
        }

        .user-list .activity-icon i.fa-gamepad {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
        }

        .user-list .activity-icon i.fa-coins {
            background: linear-gradient(45deg, #f39c12, #e67e22);
        }

        .user-list .activity-icon i.fa-trophy {
            background: linear-gradient(45deg, #f1c40f, #f39c12);
        }

        .user-list .activity-icon i.fa-exchange-alt {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }

        .user-list .activity-icon i.fa-user-check {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
        }

        .user-list .activity-content {
            flex: 1;
            min-width: 0;
        }

        .user-list .activity-text {
            color: #ffffff;
            font-size: 0.9rem;
            margin-bottom: 4px;
            font-weight: 500;
            line-height: 1.4;
        }

        .user-list .activity-text strong {
            color: #ff6b9d;
            font-weight: 600;
        }

        .user-list .activity-time {
            color: rgba(232, 232, 232, 0.7);
            font-size: 0.8rem;
            font-weight: 400;
            line-height: 1.3;
        }

        .user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff6b9d, #c44569);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .user-details h4 {
            margin-bottom: 5px;
            color: #ff6b9d;
        }

        .user-details p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .user-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn-edit {
            background: linear-gradient(45deg, #f8b500, #e55039);
            color: white;
        }

        .btn-delete {
            background: linear-gradient(45deg, #ff4757, #ff6b6b);
            color: white;
        }

        .btn-ban {
            background: linear-gradient(45deg, #ff6b6b, #ff4757);
            color: white;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }

        .back-to-home {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--color-bg);
            color: var(--text-light);
            padding: 12px 20px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            border: 1px solid rgba(64, 224, 208, 0.2);
            cursor: pointer;
            transition: background 0.2s ease;
            z-index: 1000;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .back-to-home:hover {
            background: rgba(64, 224, 208, 0.1);
        }

        .back-to-home i {
            font-size: 1.1rem;
        }

        .game-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .game-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .game-info h4 {
            margin-bottom: 5px;
            color: #ff6b9d;
        }

        .game-info p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .game-status {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .status-active {
            background: rgba(39, 174, 96, 0.2);
            color: #27ae60;
        }

        .status-inactive {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }

        .status-maintenance {
            background: rgba(243, 156, 18, 0.2);
            color: #f39c12;
        }

        .user-controls, .transaction-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .search-input, .filter-select, .date-input {
            padding: 10px 15px;
            border: 2px solid rgba(255, 107, 157, 0.3);
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
            color: white;
            font-size: 0.9rem;
        }

        .search-input:focus, .filter-select:focus, .date-input:focus {
            outline: none;
            border-color: #ff6b9d;
            box-shadow: 0 0 10px rgba(255, 107, 157, 0.3);
        }

        .reports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .report-item {
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .report-item h4 {
            color: #ff6b9d;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .report-value {
            font-size: 2rem;
            font-weight: bold;
            color: #27ae60;
            margin-bottom: 5px;
        }

        .report-change {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .chart-container {
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .analytics-item {
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 15px;
        }

        .analytics-item h4 {
            color: #ff6b9d;
            margin-bottom: 15px;
        }

        .analytics-stats {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .stat {
            display: flex;
            justify-content: space-between;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }

        .security-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .security-item {
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .security-item h4 {
            color: #ff6b9d;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .security-value {
            font-size: 2rem;
            font-weight: bold;
            color: #e74c3c;
        }

        .security-logs {
            max-height: 400px;
            overflow-y: auto;
        }

        .security-log-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .log-info h4 {
            color: #ff6b9d;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .log-info p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.8rem;
        }

        .log-time {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.8rem;
        }

        .transaction-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .transaction-info h4 {
            color: #ff6b9d;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .transaction-info p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.8rem;
        }

        .transaction-amount {
            font-size: 1.1rem;
            font-weight: bold;
        }

        .amount-positive {
            color: #27ae60;
        }

        .amount-negative {
            color: #e74c3c;
        }

        /* Visitor Analytics Styles */
        .visitor-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .visitor-stat-item {
            background: linear-gradient(135deg, rgba(20, 20, 40, 0.8) 0%, rgba(30, 30, 55, 0.6) 100%);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            padding: 24px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 
                0 12px 24px rgba(0, 0, 0, 0.3),
                0 4px 8px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .visitor-stat-item:hover {
            transform: translateY(-4px);
            box-shadow: 
                0 16px 32px rgba(0, 0, 0, 0.4),
                0 8px 16px rgba(255, 107, 157, 0.2);
            border-color: rgba(255, 255, 255, 0.12);
        }

        .visitor-stat-item h4 {
            color: #ff6b9d;
            margin-bottom: 12px;
            font-size: 0.9rem;
            font-weight: 600;
            letter-spacing: 0.02em;
            text-transform: uppercase;
            line-height: 1.3;
        }

        .visitor-stat-value {
            font-size: 2.75rem;
            font-weight: 800;
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 50%, #1abc9c 100%);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
            line-height: 1.1;
        }

        .visitor-stat-change {
            font-size: 0.875rem;
            color: rgba(232, 232, 232, 0.8);
            font-weight: 500;
            letter-spacing: 0.01em;
            line-height: 1.3;
        }

        .traffic-sources {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .traffic-source-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
        }

        .source-info h4 {
            color: #ff6b9d;
            margin-bottom: 5px;
        }

        .source-info p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .source-stats {
            text-align: right;
        }

        .source-percentage {
            font-size: 1.5rem;
            font-weight: bold;
            color: #27ae60;
        }

        .source-count {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .geo-stats {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .geo-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
        }

        .country-flag {
            font-size: 2rem;
        }

        .country-info h4 {
            color: #ff6b9d;
            margin-bottom: 5px;
        }

        .country-info p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .country-count {
            margin-left: auto;
            font-size: 1.2rem;
            font-weight: bold;
            color: #27ae60;
        }

        .device-analytics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .device-section h4 {
            color: #ff6b9d;
            margin-bottom: 20px;
        }

        .device-stats, .browser-stats {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .device-item, .browser-item {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .device-icon {
            font-size: 1.5rem;
        }

        .device-info, .browser-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .device-bar, .browser-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            overflow: hidden;
        }

        .device-fill, .browser-fill {
            height: 100%;
            background: linear-gradient(45deg, #ff6b9d, #c44569);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .device-percentage, .browser-percentage {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
            min-width: 40px;
            text-align: right;
        }

        .browser-name {
            color: #ff6b9d;
            font-weight: bold;
            min-width: 80px;
        }

        .realtime-visitors {
            max-height: 400px;
            overflow-y: auto;
        }

        .realtime-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            margin-bottom: 10px;
        }

        .visitor-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--accent-2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--color-bg);
        }

        .visitor-info h4 {
            color: var(--accent-2);
            margin-bottom: 5px;
        }

        .visitor-info p {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .visitor-location {
            margin-left: auto;
            font-size: 1.2rem;
        }

        @media (max-width: 768px) {
            .admin-container {
                padding: 10px;
            }
            
            .admin-title {
                font-size: 2rem;
            }
            
            .admin-nav {
                flex-direction: column;
            }
            
            .admin-content {
                grid-template-columns: 1fr;
            }

            .user-controls, .transaction-controls {
                flex-direction: column;
            }

            .reports-grid, .analytics-grid, .security-stats {
                grid-template-columns: 1fr;
            }

            .visitor-stats-grid {
                grid-template-columns: 1fr;
            }

            .device-analytics {
                grid-template-columns: 1fr;
            }

            .traffic-sources {
                gap: 10px;
            }

            .traffic-source-item {
                flex-direction: column;
                text-align: center;
                gap: 10px;
            }

            .source-stats {
                text-align: center;
            }
        }

        /* Game Management Styles */
        .game-upload-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .game-upload-section h4 {
            color: #e8e8e8;
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .upload-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-row .full-width {
            grid-column: 1 / -1;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-group label {
            color: #e8e8e8;
            font-weight: 500;
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 0.75rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            color: #e8e8e8;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #27ae60;
            box-shadow: 0 0 0 2px rgba(39, 174, 96, 0.2);
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .form-group small {
            color: #a0a0a0;
            font-size: 0.8rem;
            margin-top: 0.25rem;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .btn-primary,
        .btn-secondary {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(39, 174, 96, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #e8e8e8;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        .game-list-section {
            margin-top: 2rem;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .section-header h4 {
            color: #e8e8e8;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .game-filters {
            display: flex;
            gap: 1rem;
        }

        .game-filters select {
            padding: 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.05);
            color: #e8e8e8;
            font-size: 0.9rem;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .game-card {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .game-card:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .game-info h5 {
            color: #e8e8e8;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .game-category {
            color: #a0a0a0;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .game-status {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .game-status.active {
            background: rgba(39, 174, 96, 0.2);
            color: #27ae60;
        }

        .game-status.inactive {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }

        .game-status.maintenance {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
        }

        .game-details {
            margin-bottom: 1rem;
        }

        .game-detail {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .game-detail span:first-child {
            color: #a0a0a0;
            font-size: 0.9rem;
        }

        .game-detail span:last-child {
            color: #e8e8e8;
            font-weight: 500;
        }

        .game-actions {
            display: flex;
            gap: 0.5rem;
        }

        .game-action-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .game-action-btn.edit {
            background: rgba(52, 152, 219, 0.2);
            color: #3498db;
            border: 1px solid rgba(52, 152, 219, 0.3);
        }

        .game-action-btn.edit:hover {
            background: rgba(52, 152, 219, 0.3);
        }

        .game-action-btn.delete {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.3);
        }

        .game-action-btn.delete:hover {
            background: rgba(231, 76, 60, 0.3);
        }

        .game-action-btn.toggle {
            background: rgba(39, 174, 96, 0.2);
            color: #27ae60;
            border: 1px solid rgba(39, 174, 96, 0.3);
        }

        .game-action-btn.toggle:hover {
            background: rgba(39, 174, 96, 0.3);
        }

        /* Reports Section Styles */
        .report-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .date-range-selector {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .date-range-selector label {
            color: #e8e8e8;
            font-weight: 500;
        }

        .date-range-selector select {
            padding: 0.5rem 1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.05);
            color: #e8e8e8;
            font-size: 0.9rem;
        }

        .report-actions {
            display: flex;
            gap: 1rem;
        }

        .reports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .report-item {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .report-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .report-item h4 {
            color: #a0a0a0;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .report-value {
            color: #e8e8e8;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .report-change {
            font-size: 0.9rem;
            font-weight: 600;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
        }

        .report-change.positive {
            color: #27ae60;
            background: rgba(39, 174, 96, 0.2);
        }

        .report-change.negative {
            color: #e74c3c;
            background: rgba(231, 76, 60, 0.2);
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .game-performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
        }

        .game-performance-item {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .game-performance-info h5 {
            color: #e8e8e8;
            font-size: 1rem;
            margin-bottom: 0.25rem;
        }

        .game-performance-stats {
            text-align: right;
        }

        .game-performance-stats .stat {
            color: #a0a0a0;
            font-size: 0.8rem;
            margin-bottom: 0.25rem;
        }

        .game-performance-stats .value {
            color: #e8e8e8;
            font-weight: 600;
        }

        .transaction-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .transaction-summary-item {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
        }

        .transaction-summary-item h5 {
            color: #a0a0a0;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .transaction-summary-item .value {
            color: #e8e8e8;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .transaction-summary-item .count {
            color: #a0a0a0;
            font-size: 0.8rem;
            margin-top: 0.25rem;
        }

        .login-analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .login-analytics-item {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .login-analytics-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .login-analytics-item h5 {
            color: #a0a0a0;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .login-analytics-item .value {
            color: #e8e8e8;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .login-analytics-item .subtitle {
            color: #a0a0a0;
            font-size: 0.8rem;
            margin-bottom: 0.5rem;
        }

        .login-analytics-item .change {
            font-size: 0.9rem;
            font-weight: 600;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
        }

        .login-analytics-item .change.positive {
            color: #27ae60;
            background: rgba(39, 174, 96, 0.2);
        }

        .login-analytics-item .change.negative {
            color: #e74c3c;
            background: rgba(231, 76, 60, 0.2);
        }
    </style>
</head>
<body>
    <button class="back-to-home" onclick="confirmLeaveAdmin()">
        <i class="fas fa-arrow-left"></i>
        Back to Home
    </button>
    
    <div class="admin-container">
        <!-- Admin Header with Stats -->
        <div class="admin-header">
            <div class="header-content">
                <div class="header-left">
                    <h1 class="admin-title">
                        <i class="fas fa-crown"></i>
                        Arcane Games Admin
                    </h1>
                    <p class="admin-subtitle">Real-time Platform Management</p>
                </div>
                <div class="header-stats">
                    <div class="header-stat">
                        <div class="stat-icon online">
                            <i class="fas fa-circle"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="onlineUsers">0</span>
                            <span class="stat-label">Online Now</span>
                        </div>
                    </div>
                    <div class="header-stat">
                        <div class="stat-icon revenue">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="todayRevenue">$0</span>
                            <span class="stat-label">Today's Revenue</span>
                        </div>
                    </div>
                    <div class="header-stat">
                        <div class="stat-icon games">
                            <i class="fas fa-gamepad"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="activeGames">0</span>
                            <span class="stat-label">Active Games</span>
                        </div>
                    </div>
                    <button onclick="clearAllDemoData(); location.reload();" style="background: #e74c3c; color: white; border: none; padding: 12px 20px; border-radius: 8px; cursor: pointer; margin-left: 20px; font-weight: 600; transition: all 0.3s ease;">
                        <i class="fas fa-trash"></i> Clear All Data
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Key Metrics Row -->
            <div class="metrics-row">
                <div class="metric-card primary">
                    <div class="metric-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="metric-content">
                        <h3>Total Users</h3>
                        <div class="metric-value" id="totalUsersCount">0</div>
                        <div class="metric-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span id="usersChange">+12%</span>
                        </div>
                    </div>
                </div>
                
                <div class="metric-card success">
                    <div class="metric-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="metric-content">
                        <h3>Revenue</h3>
                        <div class="metric-value" id="totalRevenueAmount">$0</div>
                        <div class="metric-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span id="revenueChange">+8.5%</span>
                        </div>
                    </div>
                </div>
                
                <div class="metric-card warning">
                    <div class="metric-icon">
                        <i class="fas fa-coins"></i>
                    </div>
                    <div class="metric-content">
                        <h3>Transactions</h3>
                        <div class="metric-value" id="totalTransactionsCount">0</div>
                        <div class="metric-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span id="transactionsChange">+15%</span>
                        </div>
                    </div>
                </div>
                
                <div class="metric-card info">
                    <div class="metric-icon">
                        <i class="fas fa-eye"></i>
                    </div>
                    <div class="metric-content">
                        <h3>Page Views</h3>
                        <div class="metric-value" id="totalPageViews">0</div>
                        <div class="metric-change positive">
                            <i class="fas fa-arrow-up"></i>
                            <span id="pageViewsChange">+22%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts and Analytics Row -->
            <div class="charts-row">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3><i class="fas fa-chart-area"></i> Revenue Trend</h3>
                        <div class="chart-controls">
                            <select id="revenuePeriod">
                                <option value="7d">Last 7 Days</option>
                                <option value="30d">Last 30 Days</option>
                                <option value="90d">Last 90 Days</option>
                            </select>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="revenueChart" width="500" height="250"></canvas>
                    </div>
                </div>
                
                <div class="chart-card">
                    <div class="chart-header">
                        <h3><i class="fas fa-users"></i> User Growth</h3>
                        <div class="chart-controls">
                            <select id="userPeriod">
                                <option value="7d">Last 7 Days</option>
                                <option value="30d">Last 30 Days</option>
                                <option value="90d">Last 90 Days</option>
                            </select>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="userChart" width="500" height="250"></canvas>
                    </div>
                </div>
            </div>

            <!-- Real-time Data Row -->
            <div class="realtime-row">
                <div class="realtime-card">
                    <div class="card-header">
                        <h3><i class="fas fa-clock"></i> Real-time Activity</h3>
                        <div class="live-indicator">
                            <span class="pulse"></span>
                            LIVE
                        </div>
                    </div>
                    <div class="activity-feed" id="activityFeed">
                        <!-- Activity items will be loaded here -->
                    </div>
                </div>
                
                <div class="realtime-card">
                    <div class="card-header">
                        <h3><i class="fas fa-globe"></i> Geographic Distribution</h3>
                    </div>
                    <div class="geo-stats" id="geoStats">
                        <!-- Geographic stats will be loaded here -->
                    </div>
                </div>
                
                <div class="realtime-card">
                    <div class="card-header">
                        <h3><i class="fas fa-shield-alt"></i> Security Alerts</h3>
                    </div>
                    <div class="security-alerts" id="securityAlerts">
                        <!-- Security alerts will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Management Tools Row -->
            <div class="management-row">
                <div class="management-card">
                    <div class="card-header">
                        <h3><i class="fas fa-user-cog"></i> User Management</h3>
                        <button class="btn-primary" onclick="showUserManagement()">
                            <i class="fas fa-cog"></i> Manage
                        </button>
                    </div>
                    <div class="management-stats">
                        <div class="management-stat">
                            <span class="stat-label">New Users Today</span>
                            <span class="stat-value" id="newUsersToday">0</span>
                        </div>
                        <div class="management-stat">
                            <span class="stat-label">Active Users</span>
                            <span class="stat-value" id="activeUsersCount">0</span>
                        </div>
                        <div class="management-stat">
                            <span class="stat-label">Banned Users</span>
                            <span class="stat-value" id="bannedUsers">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="management-card">
                    <div class="card-header">
                        <h3><i class="fas fa-gamepad"></i> Game Management</h3>
                        <button class="btn-primary" onclick="showGameManagement()">
                            <i class="fas fa-cog"></i> Manage
                        </button>
                    </div>
                    <div class="game-stats" id="gameStatsList">
                        <!-- Games will be loaded dynamically from localStorage -->
                        <div style="text-align: center; padding: 20px; color: var(--text-muted);">
                            No games added yet. Use "Add New Game" to get started.
                        </div>
                    </div>
                </div>
                
                <div class="management-card">
                    <div class="card-header">
                        <h3><i class="fas fa-chart-pie"></i> Quick Reports</h3>
                        <button class="btn-primary" onclick="showReports()">
                            <i class="fas fa-file-alt"></i> View All
                        </button>
                    </div>
                    <div class="report-links">
                        <a href="#" class="report-link" onclick="generateReport('daily')">
                            <i class="fas fa-download"></i>
                            <span>Daily Report</span>
                        </a>
                        <a href="#" class="report-link" onclick="generateReport('weekly')">
                            <i class="fas fa-download"></i>
                            <span>Weekly Report</span>
                        </a>
                        <a href="#" class="report-link" onclick="generateReport('monthly')">
                            <i class="fas fa-download"></i>
                            <span>Monthly Report</span>
                        </a>
                        <a href="#" class="report-link" onclick="showGameManagement()">
                            <i class="fas fa-gamepad"></i>
                            <span>Game Management</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="admin-content">
            <!-- Dashboard Section -->
            <div id="dashboard-section" class="admin-section">
                <div class="admin-card">
                    <h3 class="card-title">Platform Overview</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value" id="totalUsers">0</div>
                            <div class="stat-label">Total Users</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="activeUsers">0</div>
                            <div class="stat-label">Active Users</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="newUsersToday">0</div>
                            <div class="stat-label">New Users Today</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="totalRevenue">$0</div>
                            <div class="stat-label">Total Revenue</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="revenueToday">$0</div>
                            <div class="stat-label">Revenue Today</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="totalTransactions">0</div>
                            <div class="stat-label">Total Transactions</div>
                        </div>
                    </div>
                </div>

                <div class="admin-card">
                    <h3 class="card-title">Recent Activity</h3>
                    <div class="user-list" id="recentActivity">
                        <!-- Activity will be populated dynamically from real data -->
                    </div>
                </div>
            </div>

            <!-- User Management Section -->
            <div id="users-section" class="admin-section" style="display: none;">
                <div class="admin-card">
                    <h3 class="card-title">User Management</h3>
                    <div class="user-controls">
                        <input type="text" id="userSearch" placeholder="Search users..." class="search-input">
                        <select id="userFilter" class="filter-select">
                            <option value="all">All Users</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <option value="new">New (Last 7 days)</option>
                        </select>
                    </div>
                    <div class="user-list" id="usersList">
                        <!-- Users will be loaded here -->
                    </div>
                </div>
            </div>

        </div>

        <!-- Reports Section -->
        <div class="admin-content" id="reports-section" style="display: none;">
                <div class="admin-card">
                    <h3 class="card-title">Financial Reports</h3>
                    <div class="report-controls">
                        <div class="date-range-selector">
                            <label for="reportDateRange">Date Range:</label>
                            <select id="reportDateRange" onchange="updateReportData()">
                                <option value="today">Today</option>
                                <option value="yesterday">Yesterday</option>
                                <option value="week">This Week</option>
                                <option value="month" selected>This Month</option>
                                <option value="quarter">This Quarter</option>
                                <option value="year">This Year</option>
                                <option value="custom">Custom Range</option>
                            </select>
                        </div>
                        <div class="report-actions">
                            <button class="btn-primary" onclick="exportReport('pdf')">
                                <i class="fas fa-file-pdf"></i> Export PDF
                            </button>
                            <button class="btn-secondary" onclick="exportReport('csv')">
                                <i class="fas fa-file-csv"></i> Export CSV
                            </button>
                        </div>
                    </div>
                    
                    <div class="reports-grid">
                        <div class="report-item">
                            <h4>Total Revenue</h4>
                            <div class="report-value" id="totalRevenue">$0</div>
                            <div class="report-change" id="revenueChange">+0%</div>
                        </div>
                        <div class="report-item">
                            <h4>Daily Revenue</h4>
                            <div class="report-value" id="dailyRevenue">$0</div>
                            <div class="report-change" id="dailyRevenueChange">+0%</div>
                        </div>
                        <div class="report-item">
                            <h4>User Deposits</h4>
                            <div class="report-value" id="totalDeposits">$0</div>
                            <div class="report-change" id="depositsChange">+0%</div>
                        </div>
                        <div class="report-item">
                            <h4>User Withdrawals</h4>
                            <div class="report-value" id="totalWithdrawals">$0</div>
                            <div class="report-change" id="withdrawalsChange">+0%</div>
                        </div>
                        <div class="report-item">
                            <h4>Net Profit</h4>
                            <div class="report-value" id="netProfit">$0</div>
                            <div class="report-change" id="profitChange">+0%</div>
                        </div>
                        <div class="report-item">
                            <h4>Active Users</h4>
                            <div class="report-value" id="activeUsersReport">0</div>
                            <div class="report-change" id="usersChange">+0%</div>
                        </div>
                        <div class="report-item">
                            <h4>Email Logins Today</h4>
                            <div class="report-value" id="emailLoginsToday">0</div>
                            <div class="report-change" id="emailLoginsChange">+0%</div>
                        </div>
                        <div class="report-item">
                            <h4>Phone Logins Today</h4>
                            <div class="report-value" id="phoneLoginsToday">0</div>
                            <div class="report-change" id="phoneLoginsChange">+0%</div>
                        </div>
                        <div class="report-item">
                            <h4>Total Logins Today</h4>
                            <div class="report-value" id="totalLoginsToday">0</div>
                            <div class="report-change" id="totalLoginsChange">+0%</div>
                        </div>
                        <div class="report-item">
                            <h4>New Registrations</h4>
                            <div class="report-value" id="newRegistrations">0</div>
                            <div class="report-change" id="registrationsChange">+0%</div>
                        </div>
                        <div class="report-item">
                            <h4>Avg Session Time</h4>
                            <div class="report-value" id="avgSessionTime">0m</div>
                            <div class="report-change" id="sessionTimeChange">+0%</div>
                        </div>
                    </div>
                </div>

                <div class="admin-card">
                    <h3 class="card-title">Revenue Trends</h3>
                    <div class="chart-container">
                        <canvas id="revenueChart" width="500" height="250"></canvas>
                    </div>
                </div>

                <div class="admin-card">
                    <h3 class="card-title">User Growth Report</h3>
                    <div class="chart-container">
                        <canvas id="userGrowthChart" width="400" height="200"></canvas>
                    </div>
                </div>

                <div class="admin-card">
                    <h3 class="card-title">Game Performance Report</h3>
                    <div class="game-performance-grid" id="gamePerformanceGrid">
                        <!-- Game performance data will be loaded here -->
                    </div>
                </div>

                <div class="admin-card">
                    <h3 class="card-title">Login Analytics</h3>
                    <div class="login-analytics-grid" id="loginAnalyticsGrid">
                        <!-- Login analytics will be loaded here -->
                    </div>
                </div>

                <div class="admin-card">
                    <h3 class="card-title">Transaction Summary</h3>
                    <div class="transaction-summary" id="transactionSummary">
                        <!-- Transaction summary will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Transactions Section -->
            <div id="transactions-section" class="admin-section" style="display: none;">
                <div class="admin-card">
                    <h3 class="card-title">Transaction Management</h3>
                    <div class="transaction-controls">
                        <select id="transactionFilter" class="filter-select">
                            <option value="all">All Transactions</option>
                            <option value="deposit">Deposits</option>
                            <option value="withdrawal">Withdrawals</option>
                            <option value="bet">Bets</option>
                            <option value="win">Wins</option>
                        </select>
                        <input type="date" id="transactionDateFrom" class="date-input">
                        <input type="date" id="transactionDateTo" class="date-input">
                    </div>
                    <div class="transaction-list" id="transactionList">
                        <!-- Transactions will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Analytics Section -->
            <div id="analytics-section" class="admin-section" style="display: none;">
                <div class="admin-card">
                    <h3 class="card-title">Game Performance</h3>
                    <div class="analytics-grid" id="gameAnalyticsGrid">
                        <!-- Game analytics will be populated dynamically -->
                        <div style="text-align: center; padding: 40px; color: var(--text-muted); grid-column: 1 / -1;">
                            <i class="fas fa-gamepad" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.3;"></i>
                            <p>No games added yet. Add games through Game Management.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Visitor Analytics Section -->
            <div id="visitor-analytics-section" class="admin-section" style="display: none;">
                <div class="admin-card">
                    <h3 class="card-title">Visitor Overview</h3>
                    <div class="visitor-stats-grid">
                        <div class="visitor-stat-item">
                            <h4>Total Visitors</h4>
                            <div class="visitor-stat-value" id="totalVisitors">0</div>
                            <div class="visitor-stat-change" id="visitorsChange">+0%</div>
                        </div>
                        <div class="visitor-stat-item">
                            <h4>Unique Visitors</h4>
                            <div class="visitor-stat-value" id="uniqueVisitors">0</div>
                            <div class="visitor-stat-change" id="uniqueVisitorsChange">+0%</div>
                        </div>
                        <div class="visitor-stat-item">
                            <h4>Page Views</h4>
                            <div class="visitor-stat-value" id="pageViews">0</div>
                            <div class="visitor-stat-change" id="pageViewsChange">+0%</div>
                        </div>
                        <div class="visitor-stat-item">
                            <h4>Bounce Rate</h4>
                            <div class="visitor-stat-value" id="bounceRate">0%</div>
                            <div class="visitor-stat-change" id="bounceRateChange">+0%</div>
                        </div>
                        <div class="visitor-stat-item">
                            <h4>Avg. Session Time</h4>
                            <div class="visitor-stat-value" id="avgSessionTime">0m</div>
                            <div class="visitor-stat-change" id="sessionTimeChange">+0%</div>
                        </div>
                        <div class="visitor-stat-item">
                            <h4>Conversion Rate</h4>
                            <div class="visitor-stat-value" id="conversionRate">0%</div>
                            <div class="visitor-stat-change" id="conversionRateChange">+0%</div>
                        </div>
                    </div>
                </div>

                <div class="admin-card">
                    <h3 class="card-title">Visitor Trends (Last 30 Days)</h3>
                    <div class="chart-container">
                        <canvas id="visitorTrendsChart" width="800" height="400"></canvas>
                    </div>
                </div>

                <div class="admin-card">
                    <h3 class="card-title">Traffic Sources</h3>
                    <div class="traffic-sources">
                        <div class="traffic-source-item">
                            <div class="source-info">
                                <h4>Direct</h4>
                                <p>Users typing URL directly</p>
                            </div>
                            <div class="source-stats">
                                <div class="source-percentage" id="directPercentage">45%</div>
                                <div class="source-count" id="directCount">0 visitors</div>
                            </div>
                        </div>
                        <div class="traffic-source-item">
                            <div class="source-info">
                                <h4>Search Engines</h4>
                                <p>Google, Bing, Yahoo</p>
                            </div>
                            <div class="source-stats">
                                <div class="source-percentage" id="searchPercentage">30%</div>
                                <div class="source-count" id="searchCount">0 visitors</div>
                            </div>
                        </div>
                        <div class="traffic-source-item">
                            <div class="source-info">
                                <h4>Social Media</h4>
                                <p>Facebook, Twitter, Instagram</p>
                            </div>
                            <div class="source-stats">
                                <div class="source-percentage" id="socialPercentage">15%</div>
                                <div class="source-count" id="socialCount">0 visitors</div>
                            </div>
                        </div>
                        <div class="traffic-source-item">
                            <div class="source-info">
                                <h4>Referrals</h4>
                                <p>Other websites</p>
                            </div>
                            <div class="source-stats">
                                <div class="source-percentage" id="referralPercentage">10%</div>
                                <div class="source-count" id="referralCount">0 visitors</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="admin-card">
                    <h3 class="card-title">Geographic Distribution</h3>
                    <div class="geo-stats">
                        <div class="geo-item">
                            <div class="country-flag"></div>
                            <div class="country-info">
                                <h4>United States</h4>
                                <p>35% of visitors</p>
                            </div>
                            <div class="country-count" id="usCount">0</div>
                        </div>
                        <div class="geo-item">
                            <div class="country-flag"></div>
                            <div class="country-info">
                                <h4>United Kingdom</h4>
                                <p>20% of visitors</p>
                            </div>
                            <div class="country-count" id="ukCount">0</div>
                        </div>
                        <div class="geo-item">
                            <div class="country-flag"></div>
                            <div class="country-info">
                                <h4>Canada</h4>
                                <p>15% of visitors</p>
                            </div>
                            <div class="country-count" id="caCount">0</div>
                        </div>
                        <div class="geo-item">
                            <div class="country-flag"></div>
                            <div class="country-info">
                                <h4>Australia</h4>
                                <p>10% of visitors</p>
                            </div>
                            <div class="country-count" id="auCount">0</div>
                        </div>
                        <div class="geo-item">
                            <div class="country-flag"></div>
                            <div class="country-info">
                                <h4>Other Countries</h4>
                                <p>20% of visitors</p>
                            </div>
                            <div class="country-count" id="otherCount">0</div>
                        </div>
                    </div>
                </div>

                <div class="admin-card">
                    <h3 class="card-title">Device & Browser Analytics</h3>
                    <div class="device-analytics">
                        <div class="device-section">
                            <h4>Device Types</h4>
                            <div class="device-stats">
                                <div class="device-item">
                                    <div class="device-icon"></div>
                                    <div class="device-info">
                                        <span>Desktop</span>
                                        <div class="device-bar">
                                            <div class="device-fill" style="width: 60%"></div>
                                        </div>
                                        <span class="device-percentage">60%</span>
                                    </div>
                                </div>
                                <div class="device-item">
                                    <div class="device-icon"></div>
                                    <div class="device-info">
                                        <span>Mobile</span>
                                        <div class="device-bar">
                                            <div class="device-fill" style="width: 35%"></div>
                                        </div>
                                        <span class="device-percentage">35%</span>
                                    </div>
                                </div>
                                <div class="device-item">
                                    <div class="device-icon"></div>
                                    <div class="device-info">
                                        <span>Tablet</span>
                                        <div class="device-bar">
                                            <div class="device-fill" style="width: 5%"></div>
                                        </div>
                                        <span class="device-percentage">5%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="device-section">
                            <h4>Top Browsers</h4>
                            <div class="browser-stats">
                                <div class="browser-item">
                                    <div class="browser-name">Chrome</div>
                                    <div class="browser-bar">
                                        <div class="browser-fill" style="width: 65%"></div>
                                    </div>
                                    <div class="browser-percentage">65%</div>
                                </div>
                                <div class="browser-item">
                                    <div class="browser-name">Safari</div>
                                    <div class="browser-bar">
                                        <div class="browser-fill" style="width: 20%"></div>
                                    </div>
                                    <div class="browser-percentage">20%</div>
                                </div>
                                <div class="browser-item">
                                    <div class="browser-name">Firefox</div>
                                    <div class="browser-bar">
                                        <div class="browser-fill" style="width: 10%"></div>
                                    </div>
                                    <div class="browser-percentage">10%</div>
                                </div>
                                <div class="browser-item">
                                    <div class="browser-name">Edge</div>
                                    <div class="browser-bar">
                                        <div class="browser-fill" style="width: 5%"></div>
                                    </div>
                                    <div class="browser-percentage">5%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="admin-card">
                    <h3 class="card-title">Real-time Visitors</h3>
                    <div class="realtime-visitors" id="realtimeVisitors">
                        <div class="realtime-item">
                            <div class="visitor-avatar">A</div>
                            <div class="visitor-info">
                                <h4>Anonymous User</h4>
                                <p>Viewing: Homepage  2 minutes ago</p>
                            </div>
                            <div class="visitor-location"> New York</div>
                        </div>
                        <div class="realtime-item">
                            <div class="visitor-avatar">B</div>
                            <div class="visitor-info">
                                <h4>Anonymous User</h4>
                                <p>Viewing: Login Page  1 minute ago</p>
                            </div>
                            <div class="visitor-location"> London</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Security Section -->
            <div id="security-section" class="admin-section" style="display: none;">
                <div class="admin-card">
                    <h3 class="card-title">Security Monitoring</h3>
                    <div class="security-stats">
                        <div class="security-item">
                            <h4>Failed Login Attempts</h4>
                            <div class="security-value" id="failedLogins">0</div>
                        </div>
                        <div class="security-item">
                            <h4>Suspicious Activities</h4>
                            <div class="security-value" id="suspiciousActivities">0</div>
                        </div>
                        <div class="security-item">
                            <h4>Blocked IPs</h4>
                            <div class="security-value" id="blockedIPs">0</div>
                        </div>
                    </div>
                </div>

                <div class="admin-card">
                    <h3 class="card-title">Security Logs</h3>
                    <div class="security-logs" id="securityLogs">
                        <!-- Security logs will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Management Section -->
        <div class="admin-content" id="gameManagement-section" style="display: none;">
            <div class="admin-card">
                <h3 class="card-title">
                    <i class="fas fa-gamepad"></i>
                    Game Management
                </h3>
                <p class="card-subtitle">Add, edit, and manage games from online marketplaces</p>
                
                <!-- Add Game Section -->
                <div class="game-upload-section">
                    <h4>Add New Game</h4>
                    <div class="upload-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="gameName">Game Name</label>
                                <input type="text" id="gameName" placeholder="Enter game name">
                            </div>
                            <div class="form-group">
                                <label for="gameCategory">Category</label>
                                <select id="gameCategory">
                                    <option value="slots">Slots</option>
                                    <option value="table">Table Games</option>
                                    <option value="live">Live Casino</option>
                                    <option value="sports">Sports</option>
                                    <option value="lottery">Lottery</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="gameProvider">Provider</label>
                                <input type="text" id="gameProvider" placeholder="e.g., NetEnt, Microgaming, Evolution">
                            </div>
                            <div class="form-group">
                                <label for="gameRTP">RTP (%)</label>
                                <input type="number" id="gameRTP" placeholder="96.5" min="0" max="100" step="0.1">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="gameFile">Game File (HTML/JS)</label>
                                <input type="file" id="gameFile" accept=".html,.js,.css" multiple>
                                <small>Upload game files or paste marketplace URL</small>
                            </div>
                            <div class="form-group">
                                <label for="gameUrl">Marketplace URL</label>
                                <input type="url" id="gameUrl" placeholder="https://marketplace.com/game">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group full-width">
                                <label for="gameDescription">Description</label>
                                <textarea id="gameDescription" placeholder="Game description and features"></textarea>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="gameThumbnail">Thumbnail URL</label>
                                <input type="url" id="gameThumbnail" placeholder="https://example.com/thumbnail.jpg">
                            </div>
                            <div class="form-group">
                                <label for="gameStatus">Status</label>
                                <select id="gameStatus">
                                    <option value="active">Active</option>
                                    <option value="inactive">Inactive</option>
                                    <option value="maintenance">Maintenance</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button class="btn-primary" onclick="addGame()">
                                <i class="fas fa-plus"></i>
                                Add Game
                            </button>
                            <button class="btn-secondary" onclick="previewGame()">
                                <i class="fas fa-eye"></i>
                                Preview
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Game List Section -->
                <div class="game-list-section">
                    <div class="section-header">
                        <h4>Current Games</h4>
                        <div class="game-filters">
                            <select id="categoryFilter" onchange="filterGames()">
                                <option value="all">All Categories</option>
                                <option value="slots">Slots</option>
                                <option value="table">Table Games</option>
                                <option value="live">Live Casino</option>
                                <option value="sports">Sports</option>
                                <option value="lottery">Lottery</option>
                            </select>
                            <select id="statusFilter" onchange="filterGames()">
                                <option value="all">All Status</option>
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                                <option value="maintenance">Maintenance</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="games-grid" id="gamesGrid">
                        <!-- Games will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="user-activity-tracker.js"></script>
    <script src="visitor-tracking.js"></script>
    <script src="security.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        // Check admin authentication
        window.addEventListener('load', function() {
            const token = localStorage.getItem('token');
            const user = JSON.parse(localStorage.getItem('user') || '{}');
            
            // Check if user is logged in and is admin
            if (!token || !user.email || user.email !== 'admin@arcanegames.com') {
                // Redirect to login page
                window.location.href = 'login.html';
                return;
            }
            
            // Initialize admin panel without clearing data
            console.log('Initializing admin panel...');
            
            // Initialize admin panel
            initializeDashboard();
            loadUsers();
            updateStats();
            initializeGames();
            startRealTimeUpdates();
            
            console.log('Admin panel initialized successfully');
        });

        // Force clear all demo data (preserve admin login)
        function clearAllDemoData() {
            // Preserve admin login data
            const token = localStorage.getItem('token');
            const user = localStorage.getItem('user');
            
            // Clear ALL localStorage data
            localStorage.clear();
            
            // Restore admin login data
            if (token) {
                localStorage.setItem('token', token);
            }
            if (user) {
                localStorage.setItem('user', user);
            }
            
            // Ensure admin account exists
            setupAdminAccount();
            
            // Re-initialize with empty data
            localStorage.setItem('users', JSON.stringify([]));
            localStorage.setItem('transactions', JSON.stringify([]));
            localStorage.setItem('games', JSON.stringify([]));
            localStorage.setItem('visitor_analytics', JSON.stringify({
                totalVisitors: 0,
                uniqueVisitors: 0,
                pageViews: 0,
                sessions: [],
                trafficSources: {},
                geographicData: {},
                deviceInfo: {},
                lastUpdated: new Date().toISOString()
            }));
            
            // Clear demo games from admin panel display
            clearDemoGamesFromAdmin();
            
            // Show success message
            alert('All demo data cleared! The platform is now ready for production.');
            
            // Refresh the dashboard without reloading the page
            updateStats();
            loadUsers();
            initializeGames();
        }

        function clearDemoGamesFromAdmin() {
            // Remove demo game cards from admin panel
            const gameCards = document.querySelectorAll('.game-card');
            gameCards.forEach(card => card.remove());
            
            // Update game stats to show 0
            const activeGamesElement = document.querySelector('.stat-value');
            if (activeGamesElement) {
                activeGamesElement.textContent = '0';
            }
        }

        // Setup admin account
        function setupAdminAccount() {
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const adminExists = users.some(user => user.email === 'admin@arcanegames.com');
            
            if (!adminExists) {
                const adminUser = {
                    id: 'admin_001',
                    name: 'Admin User',
                    email: 'admin@arcanegames.com',
                    password: 'admin123', // Simple password for demo
                    role: 'admin',
                    balance: 0,
                    isActive: true,
                    createdAt: new Date().toISOString(),
                    lastLogin: new Date().toISOString()
                };
                
                users.push(adminUser);
                localStorage.setItem('users', JSON.stringify(users));
            }
        }

        // Initialize dashboard for production launch
        function initializeDashboard() {
            // Clear any existing demo data
            clearDemoData();
            
            // Load visitor analytics data
            initializeVisitorTracking();
            
            // Update all dashboard metrics
            updateDashboardMetrics();
            
            // Draw charts
            drawRevenueChart();
            drawUserChart();
            
            // Load real-time data
            loadActivityFeed();
            loadGeographicStats();
            loadSecurityAlerts();
        }

        // Clear demo data for production launch
        function clearDemoData() {
            // Clear ALL demo data from localStorage
            localStorage.removeItem('visitor_analytics');
            localStorage.removeItem('unique_visitor');
            localStorage.removeItem('users');
            localStorage.removeItem('transactions');
            localStorage.removeItem('games');
            localStorage.removeItem('login_analytics');
            localStorage.removeItem('user_sessions');
            
            // Reset visitor tracking
            const visitorData = {
                totalVisitors: 0,
                uniqueVisitors: 0,
                pageViews: 0,
                sessions: [],
                trafficSources: {},
                geographicData: {},
                deviceInfo: {},
                lastUpdated: new Date().toISOString()
            };
            localStorage.setItem('visitor_analytics', JSON.stringify(visitorData));
            
            // Initialize empty users array
            localStorage.setItem('users', JSON.stringify([]));
            
            // Initialize empty transactions array
            localStorage.setItem('transactions', JSON.stringify([]));
            
            // Initialize empty games array
            localStorage.setItem('games', JSON.stringify([]));
        }

        // Update dashboard metrics
        function updateDashboardMetrics() {
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
            const visitorData = JSON.parse(localStorage.getItem('visitor_analytics') || '{}');
            
            // Reset header stats to zero for production launch
            document.getElementById('onlineUsers').textContent = '0';
            document.getElementById('todayRevenue').textContent = '$0';
            
            // Reset metric cards to actual data (not demo data)
            document.getElementById('totalUsersCount').textContent = users.length;
            document.getElementById('totalRevenueAmount').textContent = `$${transactions.reduce((sum, t) => sum + (t.amount || 0), 0).toFixed(0)}`;
            document.getElementById('totalTransactionsCount').textContent = transactions.length;
            document.getElementById('totalPageViews').textContent = visitorData.pageViews || 0;
            
            // Reset management stats to actual data
            const today = new Date().toDateString();
            const newUsersToday = users.filter(user => 
                new Date(user.createdAt).toDateString() === today
            ).length;
            
            document.getElementById('newUsersToday').textContent = newUsersToday;
            document.getElementById('activeUsersCount').textContent = users.filter(u => u.isActive !== false).length;
            document.getElementById('bannedUsers').textContent = users.filter(u => u.isActive === false).length;
        }

        // Draw revenue chart
        function drawRevenueChart() {
            const canvas = document.getElementById('revenueChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const data = generateRevenueData();
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw chart
            drawLineChart(ctx, data, canvas.width, canvas.height, '#ff6b9d', 'Revenue');
        }

        // Draw user chart
        function drawUserChart() {
            const canvas = document.getElementById('userChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const data = generateUserData();
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw chart
            drawLineChart(ctx, data, canvas.width, canvas.height, '#27ae60', 'Users');
        }

        // Generate sample revenue data
        function generateRevenueData() {
            const data = [];
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                data.push({
                    date: date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),
                    value: 0
                });
            }
            return data;
        }

        // Generate user data (empty for production launch)
        function generateUserData() {
            const data = [];
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                data.push({
                    date: date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),
                    value: 0
                });
            }
            return data;
        }

        // Draw line chart
        function drawLineChart(ctx, data, width, height, color, label) {
            const margin = { top: 60, right: 60, bottom: 80, left: 120 };
            const chartWidth = width - margin.left - margin.right;
            const chartHeight = height - margin.top - margin.bottom;
            
            // Clear canvas
            ctx.clearRect(0, 0, width, height);
            
            // Set background with gradient
            const bgGradient = ctx.createLinearGradient(0, 0, 0, height);
            bgGradient.addColorStop(0, 'rgba(255, 255, 255, 0.03)');
            bgGradient.addColorStop(1, 'rgba(255, 255, 255, 0.01)');
            ctx.fillStyle = bgGradient;
            ctx.fillRect(0, 0, width, height);
            
            // Add subtle border
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
            ctx.lineWidth = 1;
            ctx.strokeRect(0, 0, width, height);
            
            if (data.length === 0) {
                // Draw empty state
                ctx.fillStyle = '#a0a0a0';
                ctx.font = '16px Inter, Arial, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('No data available', width / 2, height / 2);
                return;
            }
            
            // Find min and max values
            const values = data.map(d => d.value);
            const minValue = Math.min(...values);
            const maxValue = Math.max(...values);
            const valueRange = maxValue - minValue || 1;
            
            // Add padding to value range for better visualization
            const paddedMinValue = Math.max(0, minValue - valueRange * 0.1);
            const paddedMaxValue = maxValue + valueRange * 0.1;
            const paddedValueRange = paddedMaxValue - paddedMinValue;
            
            // Draw grid lines with native styling
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.05)';
            ctx.lineWidth = 1;
            ctx.setLineDash([2, 4]);
            
            // Horizontal grid lines
            for (let i = 0; i <= 5; i++) {
                const y = margin.top + (i / 5) * chartHeight;
                ctx.beginPath();
                ctx.moveTo(margin.left, y);
                ctx.lineTo(width - margin.right, y);
                ctx.stroke();
            }
            
            // Vertical grid lines
            for (let i = 0; i < data.length; i++) {
                const x = margin.left + (i / (data.length - 1)) * chartWidth;
                ctx.beginPath();
                ctx.moveTo(x, margin.top);
                ctx.lineTo(x, height - margin.bottom);
                ctx.stroke();
            }
            
            // Reset line dash
            ctx.setLineDash([]);
            
            // Draw axes with native styling
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.15)';
            ctx.lineWidth = 2;
            ctx.lineCap = 'round';
            
            // Y-axis
            ctx.beginPath();
            ctx.moveTo(margin.left, margin.top);
            ctx.lineTo(margin.left, height - margin.bottom);
            ctx.stroke();
            
            // X-axis
            ctx.beginPath();
            ctx.moveTo(margin.left, height - margin.bottom);
            ctx.lineTo(width - margin.right, height - margin.bottom);
            ctx.stroke();
            
            // Add axis arrows for native feel
            ctx.fillStyle = 'rgba(255, 255, 255, 0.15)';
            
            // Y-axis arrow
            ctx.beginPath();
            ctx.moveTo(margin.left - 5, margin.top + 10);
            ctx.lineTo(margin.left, margin.top);
            ctx.lineTo(margin.left + 5, margin.top + 10);
            ctx.closePath();
            ctx.fill();
            
            // X-axis arrow
            ctx.beginPath();
            ctx.moveTo(width - margin.right - 10, height - margin.bottom - 5);
            ctx.lineTo(width - margin.right, height - margin.bottom);
            ctx.lineTo(width - margin.right - 10, height - margin.bottom + 5);
            ctx.closePath();
            ctx.fill();
            
            // Draw area under line with gradient
            const gradient = ctx.createLinearGradient(0, margin.top, 0, height - margin.bottom);
            gradient.addColorStop(0, color + '40');
            gradient.addColorStop(1, color + '10');
            
            ctx.fillStyle = gradient;
            ctx.beginPath();
            ctx.moveTo(margin.left, height - margin.bottom);
            
            data.forEach((point, index) => {
                const x = margin.left + (index / (data.length - 1)) * chartWidth;
                const y = height - margin.bottom - ((point.value - paddedMinValue) / paddedValueRange) * chartHeight;
                ctx.lineTo(x, y);
            });
            
            ctx.lineTo(width - margin.right, height - margin.bottom);
            ctx.closePath();
            ctx.fill();
            
            // Draw line with native styling
            const lineGradient = ctx.createLinearGradient(0, margin.top, 0, height - margin.bottom);
            lineGradient.addColorStop(0, color);
            lineGradient.addColorStop(1, color + '80');
            
            ctx.strokeStyle = lineGradient;
            ctx.lineWidth = 4;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.shadowColor = color;
            ctx.shadowBlur = 8;
            ctx.beginPath();
            
            data.forEach((point, index) => {
                const x = margin.left + (index / (data.length - 1)) * chartWidth;
                const y = height - margin.bottom - ((point.value - paddedMinValue) / paddedValueRange) * chartHeight;
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.stroke();
            
            // Reset shadow
            ctx.shadowBlur = 0;
            
            // Draw data points with native styling
            data.forEach((point, index) => {
                const x = margin.left + (index / (data.length - 1)) * chartWidth;
                const y = height - margin.bottom - ((point.value - paddedMinValue) / paddedValueRange) * chartHeight;
                
                // Outer glow
                ctx.shadowColor = color;
                ctx.shadowBlur = 15;
                ctx.fillStyle = color + '40';
                ctx.beginPath();
                ctx.arc(x, y, 8, 0, 2 * Math.PI);
                ctx.fill();
                
                // Main circle
                ctx.shadowBlur = 8;
                ctx.fillStyle = color;
                ctx.beginPath();
                ctx.arc(x, y, 5, 0, 2 * Math.PI);
                ctx.fill();
                
                // Inner highlight
                ctx.shadowBlur = 0;
                ctx.fillStyle = '#ffffff';
                ctx.beginPath();
                ctx.arc(x, y, 2, 0, 2 * Math.PI);
                ctx.fill();
            });
            
            // Draw labels
            ctx.fillStyle = '#e8e8e8';
            ctx.font = 'bold 11px Inter, Arial, sans-serif';
            ctx.textAlign = 'right';
            
            // Y-axis labels with proper formatting and alignment
            for (let i = 0; i <= 5; i++) {
                const value = paddedMinValue + (i / 5) * paddedValueRange;
                const y = height - margin.bottom - (i / 5) * chartHeight;
                const formattedValue = value >= 1000 ? `$${(value / 1000).toFixed(1)}k` : `$${Math.round(value)}`;
                
                // Add background for better readability
                const textWidth = ctx.measureText(formattedValue).width;
                ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
                ctx.fillRect(margin.left - textWidth - 30, y - 8, textWidth + 15, 16);
                
                // Draw the text
                ctx.fillStyle = '#e8e8e8';
                ctx.fillText(formattedValue, margin.left - 25, y + 4);
            }
            
            // X-axis labels with native styling
            ctx.textAlign = 'center';
            ctx.fillStyle = '#e8e8e8';
            ctx.font = 'bold 10px Inter, Arial, sans-serif';
            data.forEach((point, index) => {
                const x = margin.left + (index / (data.length - 1)) * chartWidth;
                
                // Add background for better readability
                const textWidth = ctx.measureText(point.date).width;
                ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';
                ctx.fillRect(x - textWidth/2 - 5, height - margin.bottom + 15, textWidth + 10, 16);
                
                // Draw the text
                ctx.fillStyle = '#e8e8e8';
                ctx.fillText(point.date, x, height - margin.bottom + 27);
            });
            
            // Chart title with native styling
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 16px Inter, Arial, sans-serif';
            ctx.textAlign = 'left';
            ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
            ctx.shadowBlur = 2;
            ctx.fillText(label, margin.left, margin.top - 25);
            
            // Reset shadow
            ctx.shadowBlur = 0;
        }

        // Load activity feed (empty for production launch)
        function loadActivityFeed() {
            const feed = document.getElementById('activityFeed');
            feed.innerHTML = `
                <div class="activity-item">
                    <div class="activity-content">
                        <div class="activity-text" style="text-align: center; color: #a0a0a0; font-style: italic;">
                            No recent activity
                        </div>
                    </div>
                </div>
            `;
        }

        // Get activity icon
        function getActivityIcon(type) {
            const icons = {
                user: 'user-plus',
                game: 'gamepad',
                transaction: 'exchange-alt',
                win: 'trophy'
            };
            return icons[type] || 'circle';
        }

        // Load geographic stats (empty for production launch)
        function loadGeographicStats() {
            const geoStats = document.getElementById('geoStats');
            geoStats.innerHTML = `
                <div class="geo-item" style="text-align: center; color: #a0a0a0; font-style: italic;">
                    No geographic data available
                </div>
            `;
        }

        // Load security alerts (empty for production launch)
        function loadSecurityAlerts() {
            const securityAlerts = document.getElementById('securityAlerts');
            securityAlerts.innerHTML = `
                <div class="alert-item" style="text-align: center; color: #a0a0a0; font-style: italic;">
                    No security alerts
                </div>
            `;
        }

        // Get alert icon
        function getAlertIcon(type) {
            const icons = {
                warning: 'exclamation-triangle',
                info: 'info-circle',
                success: 'check-circle'
            };
            return icons[type] || 'circle';
        }

        // Start real-time updates
        function startRealTimeUpdates() {
            // Update every 30 seconds
            setInterval(() => {
                updateDashboardMetrics();
                loadActivityFeed();
            }, 30000);
        }

        // Management functions
        function showUserManagement() {
            alert('User Management - This would open a detailed user management interface');
        }

        function showGameManagement() {
            alert('Game Management - This would open a detailed game management interface');
        }

        function showReports() {
            alert('Reports - This would open a detailed reports interface');
        }

        // Show different sections
        function showSection(sectionName) {
            // Hide all sections
            const sections = document.querySelectorAll('.admin-section');
            sections.forEach(section => {
                section.style.display = 'none';
            });

            // Remove active class from all nav buttons
            const navBtns = document.querySelectorAll('.nav-btn');
            navBtns.forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected section
            document.getElementById(sectionName + '-section').style.display = 'block';
            
            // Add active class to clicked button
            event.target.classList.add('active');

            // Load section-specific data
            loadSectionData(sectionName);
        }

        // Load data for specific sections
        function loadSectionData(sectionName) {
            switch(sectionName) {
                case 'dashboard':
                    loadDashboardData();
                    break;
                case 'users':
                    loadUsersData();
                    break;
                case 'reports':
                    loadReportsData();
                    break;
                case 'transactions':
                    loadTransactionsData();
                    break;
                case 'analytics':
                    loadAnalyticsData();
                    break;
                case 'visitor-analytics':
                    loadVisitorAnalyticsData();
                    break;
                case 'security':
                    loadSecurityData();
                    break;
            }
        }

        // Load users from localStorage
        function loadUsers() {
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const usersList = document.getElementById('usersList');
            
            if (users.length === 0) {
                usersList.innerHTML = '<div class="user-item"><div class="user-info"><div class="user-details"><h4>No users registered yet</h4><p>Users will appear here when they register</p></div></div></div>';
                return;
            }

            usersList.innerHTML = users.map(user => `
                <div class="user-item">
                    <div class="user-info">
                        <div class="user-avatar">${(user.name || user.email || 'U').charAt(0).toUpperCase()}</div>
                        <div class="user-details">
                            <h4>${user.name || 'Unknown'}</h4>
                            <p>${user.email}  Balance: $${user.balance || 0}</p>
                        </div>
                    </div>
                    <div class="user-actions">
                        <button class="action-btn btn-edit" onclick="editUser('${user.id}')">Edit</button>
                        <button class="action-btn btn-ban" onclick="banUser('${user.id}')">Ban</button>
                        <button class="action-btn btn-delete" onclick="deleteUser('${user.id}')">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        // Update statistics
        function updateStats() {
            // Load game stats
            loadGameStats();
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
            
            const totalUsers = users.length;
            const activeUsers = users.filter(user => user.isActive !== false).length;
            const today = new Date().toDateString();
            const newUsersToday = users.filter(user => 
                new Date(user.createdAt).toDateString() === today
            ).length;
            
            const totalRevenue = transactions
                .filter(t => t.type === 'deposit' && t.status === 'completed')
                .reduce((sum, t) => sum + t.amount, 0);
            
            const revenueToday = transactions
                .filter(t => t.type === 'deposit' && t.status === 'completed' && 
                    new Date(t.createdAt).toDateString() === today)
                .reduce((sum, t) => sum + t.amount, 0);
            
            document.getElementById('totalUsers').textContent = totalUsers;
            document.getElementById('activeUsers').textContent = activeUsers;
            document.getElementById('newUsersToday').textContent = newUsersToday;
            document.getElementById('totalRevenue').textContent = `$${totalRevenue.toFixed(2)}`;
            document.getElementById('revenueToday').textContent = `$${revenueToday.toFixed(2)}`;
            document.getElementById('totalTransactions').textContent = transactions.length;
        }

        // Load dashboard data
        function loadDashboardData() {
            updateStats();
            loadRecentActivity();
        }

        // Load recent activity
        function loadRecentActivity() {
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
            const recentActivity = document.getElementById('recentActivity');
            
            // Get recent users (last 5)
            const recentUsers = users
                .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
                .slice(0, 5);
            
            // Get recent transactions (last 5)
            const recentTransactions = transactions
                .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
                .slice(0, 5);
            
            let activityHtml = '';
            
            recentUsers.forEach(user => {
                activityHtml += `
                    <div class="user-item">
                        <div class="user-info">
                            <div class="user-avatar">${(user.firstName || user.email || 'U').charAt(0).toUpperCase()}</div>
                            <div class="user-details">
                                <h4>New User: ${user.firstName} ${user.lastName}</h4>
                                <p>${user.email}  ${new Date(user.createdAt).toLocaleString()}</p>
                            </div>
                        </div>
                        <div class="user-actions">
                            <span style="color: #27ae60; font-size: 0.8rem;">New</span>
                        </div>
                    </div>
                `;
            });
            
            recentTransactions.forEach(transaction => {
                activityHtml += `
                    <div class="user-item">
                        <div class="user-info">
                            <div class="user-avatar">T</div>
                            <div class="user-details">
                                <h4>${transaction.type.charAt(0).toUpperCase() + transaction.type.slice(1)}</h4>
                                <p>$${transaction.amount.toFixed(2)}  ${new Date(transaction.createdAt).toLocaleString()}</p>
                            </div>
                        </div>
                        <div class="user-actions">
                            <span style="color: ${transaction.amount > 0 ? '#27ae60' : '#e74c3c'}; font-size: 0.8rem;">
                                ${transaction.amount > 0 ? '+' : ''}$${transaction.amount.toFixed(2)}
                            </span>
                        </div>
                    </div>
                `;
            });
            
            if (activityHtml === '') {
                activityHtml = '<div class="user-item"><div class="user-info"><div class="user-details"><h4>No recent activity</h4><p>Activity will appear here</p></div></div></div>';
            }
            
            recentActivity.innerHTML = activityHtml;
        }

        // Load users data
        function loadUsersData() {
            loadUsers();
        }

        // Load reports data
        function loadReportsData() {
            const transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
            const today = new Date().toDateString();
            const thisMonth = new Date().getMonth();
            const thisYear = new Date().getFullYear();
            
            // Daily revenue
            const dailyRevenue = transactions
                .filter(t => t.type === 'deposit' && t.status === 'completed' && 
                    new Date(t.createdAt).toDateString() === today)
                .reduce((sum, t) => sum + t.amount, 0);
            
            // Monthly revenue
            const monthlyRevenue = transactions
                .filter(t => t.type === 'deposit' && t.status === 'completed' && 
                    new Date(t.createdAt).getMonth() === thisMonth && 
                    new Date(t.createdAt).getFullYear() === thisYear)
                .reduce((sum, t) => sum + t.amount, 0);
            
            // Total deposits
            const totalDeposits = transactions
                .filter(t => t.type === 'deposit' && t.status === 'completed')
                .reduce((sum, t) => sum + t.amount, 0);
            
            // Total withdrawals
            const totalWithdrawals = transactions
                .filter(t => t.type === 'withdrawal' && t.status === 'completed')
                .reduce((sum, t) => sum + t.amount, 0);
            
            document.getElementById('dailyRevenue').textContent = `$${dailyRevenue.toFixed(2)}`;
            document.getElementById('monthlyRevenue').textContent = `$${monthlyRevenue.toFixed(2)}`;
            document.getElementById('totalDeposits').textContent = `$${totalDeposits.toFixed(2)}`;
            document.getElementById('totalWithdrawals').textContent = `$${totalWithdrawals.toFixed(2)}`;
        }

        // Load transactions data
        function loadTransactionsData() {
            const transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
            const transactionList = document.getElementById('transactionList');
            
            if (transactions.length === 0) {
                transactionList.innerHTML = '<div class="transaction-item"><div class="transaction-info"><h4>No transactions yet</h4><p>Transaction history will appear here</p></div></div>';
                return;
            }
            
            transactionList.innerHTML = transactions
                .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
                .map(transaction => `
                    <div class="transaction-item">
                        <div class="transaction-info">
                            <h4>${transaction.type.charAt(0).toUpperCase() + transaction.type.slice(1)}</h4>
                            <p>${transaction.description || 'No description'}  ${new Date(transaction.createdAt).toLocaleString()}</p>
                        </div>
                        <div class="transaction-amount ${transaction.amount > 0 ? 'amount-positive' : 'amount-negative'}">
                            ${transaction.amount > 0 ? '+' : ''}$${transaction.amount.toFixed(2)}
                        </div>
                    </div>
                `).join('');
        }

        // Load game stats dynamically
        function loadGameStats() {
            const games = JSON.parse(localStorage.getItem('games') || '[]');
            const gameStatsList = document.getElementById('gameStatsList');
            const gameAnalyticsGrid = document.getElementById('gameAnalyticsGrid');
            
            // Update game stats in management section
            if (gameStatsList) {
                if (games.length === 0) {
                    gameStatsList.innerHTML = '<div style="text-align: center; padding: 20px; color: var(--text-muted);">No games added yet. Use "Add New Game" to get started.</div>';
                } else {
                    gameStatsList.innerHTML = games.slice(0, 5).map(game => `
                        <div class="game-stat">
                            <div class="game-icon"></div>
                            <div class="game-info">
                                <span class="game-name">${game.name}</span>
                                <span class="game-plays">${game.plays || 0} plays</span>
                            </div>
                        </div>
                    `).join('');
                }
            }
            
            // Update analytics grid
            if (gameAnalyticsGrid) {
                if (games.length === 0) {
                    gameAnalyticsGrid.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-muted); grid-column: 1 / -1;"><i class="fas fa-gamepad" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.3;"></i><p>No games added yet. Add games through Game Management.</p></div>';
                } else {
                    gameAnalyticsGrid.innerHTML = games.map(game => `
                        <div class="analytics-item">
                            <h4>${game.name}</h4>
                            <div class="analytics-stats">
                                <div class="stat">Plays: <span>${game.plays || 0}</span></div>
                                <div class="stat">Revenue: <span>$${(game.revenue || 0).toFixed(2)}</span></div>
                                <div class="stat">RTP: ${game.rtp || 96.5}%</div>
                            </div>
                        </div>
                    `).join('');
                }
            }
        }

        // Load analytics data
        function loadAnalyticsData() {
            // Game stats will be loaded dynamically from localStorage
            loadGameStats();
        }

        // Load visitor analytics data
        function loadVisitorAnalyticsData() {
            // Initialize visitor tracking if not exists
            initializeVisitorTracking();
            
            // Load visitor data
            const visitorData = JSON.parse(localStorage.getItem('visitor_analytics') || '{}');
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            
            // Calculate metrics
            const totalVisitors = visitorData.totalVisitors || 0;
            const uniqueVisitors = visitorData.uniqueVisitors || 0;
            const pageViews = visitorData.pageViews || 0;
            const bounceRate = visitorData.bounceRate || 0;
            const avgSessionTime = visitorData.avgSessionTime || 0;
            const conversionRate = users.length > 0 ? ((users.length / totalVisitors) * 100) : 0;
            
            // Update visitor stats
            document.getElementById('totalVisitors').textContent = totalVisitors.toLocaleString();
            document.getElementById('uniqueVisitors').textContent = uniqueVisitors.toLocaleString();
            document.getElementById('pageViews').textContent = pageViews.toLocaleString();
            document.getElementById('bounceRate').textContent = bounceRate.toFixed(1) + '%';
            document.getElementById('avgSessionTime').textContent = Math.floor(avgSessionTime / 60) + 'm ' + (avgSessionTime % 60) + 's';
            document.getElementById('conversionRate').textContent = conversionRate.toFixed(1) + '%';
            
            // Update traffic sources
            updateTrafficSources(visitorData);
            
            // Update geographic data
            updateGeographicData(visitorData);
            
            // Draw visitor trends chart
            drawVisitorTrendsChart(visitorData);
            
            // Update real-time visitors
            updateRealtimeVisitors();
        }

        // Initialize visitor tracking
        function initializeVisitorTracking() {
            if (!localStorage.getItem('visitor_analytics')) {
                const visitorData = {
                    totalVisitors: 1247,
                    uniqueVisitors: 892,
                    pageViews: 3847,
                    bounceRate: 34.2,
                    avgSessionTime: 187, // in seconds
                    totalSessions: 1247,
                    trafficSources: {
                        direct: 45,
                        search: 30,
                        social: 15,
                        referral: 10
                    },
                    geographic: {
                        us: 35,
                        uk: 20,
                        ca: 15,
                        au: 10,
                        other: 20
                    },
                    dailyVisitors: generateDailyVisitorData(),
                    deviceTypes: {
                        desktop: 60,
                        mobile: 35,
                        tablet: 5
                    },
                    browsers: {
                        chrome: 65,
                        safari: 20,
                        firefox: 10,
                        edge: 5
                    },
                    realtimeVisitors: []
                };
                localStorage.setItem('visitor_analytics', JSON.stringify(visitorData));
            }
        }

        // Generate sample daily visitor data
        function generateDailyVisitorData() {
            const data = [];
            for (let i = 29; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                data.push({
                    date: date.toISOString().split('T')[0],
                    visitors: Math.floor(Math.random() * 100) + 50,
                    pageViews: Math.floor(Math.random() * 300) + 150,
                    uniqueVisitors: Math.floor(Math.random() * 80) + 40
                });
            }
            return data;
        }

        // Update traffic sources
        function updateTrafficSources(visitorData) {
            const sources = visitorData.trafficSources || {};
            const totalVisitors = visitorData.totalVisitors || 1;
            
            document.getElementById('directPercentage').textContent = sources.direct + '%';
            document.getElementById('directCount').textContent = Math.floor((sources.direct / 100) * totalVisitors) + ' visitors';
            
            document.getElementById('searchPercentage').textContent = sources.search + '%';
            document.getElementById('searchCount').textContent = Math.floor((sources.search / 100) * totalVisitors) + ' visitors';
            
            document.getElementById('socialPercentage').textContent = sources.social + '%';
            document.getElementById('socialCount').textContent = Math.floor((sources.social / 100) * totalVisitors) + ' visitors';
            
            document.getElementById('referralPercentage').textContent = sources.referral + '%';
            document.getElementById('referralCount').textContent = Math.floor((sources.referral / 100) * totalVisitors) + ' visitors';
        }

        // Update geographic data
        function updateGeographicData(visitorData) {
            const geo = visitorData.geographic || {};
            const totalVisitors = visitorData.totalVisitors || 1;
            
            document.getElementById('usCount').textContent = Math.floor((geo.us / 100) * totalVisitors);
            document.getElementById('ukCount').textContent = Math.floor((geo.uk / 100) * totalVisitors);
            document.getElementById('caCount').textContent = Math.floor((geo.ca / 100) * totalVisitors);
            document.getElementById('auCount').textContent = Math.floor((geo.au / 100) * totalVisitors);
            document.getElementById('otherCount').textContent = Math.floor((geo.other / 100) * totalVisitors);
        }

        // Draw visitor trends chart
        function drawVisitorTrendsChart(visitorData) {
            const canvas = document.getElementById('visitorTrendsChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const dailyData = visitorData.dailyVisitors || [];
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Set up chart dimensions
            const margin = 40;
            const chartWidth = canvas.width - 2 * margin;
            const chartHeight = canvas.height - 2 * margin;
            
            // Find max values for scaling
            const maxVisitors = Math.max(...dailyData.map(d => d.visitors));
            const maxPageViews = Math.max(...dailyData.map(d => d.pageViews));
            
            // Draw axes
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.lineWidth = 1;
            
            // Y-axis
            ctx.beginPath();
            ctx.moveTo(margin, margin);
            ctx.lineTo(margin, canvas.height - margin);
            ctx.stroke();
            
            // X-axis
            ctx.beginPath();
            ctx.moveTo(margin, canvas.height - margin);
            ctx.lineTo(canvas.width - margin, canvas.height - margin);
            ctx.stroke();
            
            // Draw visitor trend line
            ctx.strokeStyle = '#ff6b9d';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            dailyData.forEach((data, index) => {
                const x = margin + (index / (dailyData.length - 1)) * chartWidth;
                const y = canvas.height - margin - (data.visitors / maxVisitors) * chartHeight;
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.stroke();
            
            // Draw page views trend line
            ctx.strokeStyle = '#27ae60';
            ctx.lineWidth = 2;
            ctx.beginPath();
            
            dailyData.forEach((data, index) => {
                const x = margin + (index / (dailyData.length - 1)) * chartWidth;
                const y = canvas.height - margin - (data.pageViews / maxPageViews) * chartHeight;
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.stroke();
            
            // Add labels
            ctx.fillStyle = '#ff6b9d';
            ctx.font = '14px Arial';
            ctx.fillText('Visitors', canvas.width - 100, 30);
            
            ctx.fillStyle = '#27ae60';
            ctx.fillText('Page Views', canvas.width - 100, 50);
            
            // Add title
            ctx.fillStyle = 'white';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('Visitor Trends (Last 30 Days)', margin, 25);
        }

        // Update real-time visitors
        function updateRealtimeVisitors() {
            const realtimeVisitors = document.getElementById('realtimeVisitors');
            const visitors = [
                { id: 'A', page: 'Homepage', time: '2 minutes ago', location: ' New York' },
                { id: 'B', page: 'Login Page', time: '1 minute ago', location: ' London' },
                // { id: 'C', page: 'Game', time: '30 seconds ago', location: ' Toronto' },
                { id: 'D', page: 'Registration', time: '1 minute ago', location: ' Sydney' }
            ];
            
            realtimeVisitors.innerHTML = visitors.map(visitor => `
                <div class="realtime-item">
                    <div class="visitor-avatar">${visitor.id}</div>
                    <div class="visitor-info">
                        <h4>Anonymous User</h4>
                        <p>Viewing: ${visitor.page}  ${visitor.time}</p>
                    </div>
                    <div class="visitor-location">${visitor.location}</div>
                </div>
            `).join('');
        }

        // Load security data
        function loadSecurityData() {
            const securityLogs = JSON.parse(localStorage.getItem('security_logs') || '[]');
            const failedLogins = securityLogs.filter(log => log.eventType === 'login_failed').length;
            const suspiciousActivities = securityLogs.filter(log => 
                log.eventType.includes('suspicious') || log.eventType.includes('failed')
            ).length;
            
            document.getElementById('failedLogins').textContent = failedLogins;
            document.getElementById('suspiciousActivities').textContent = suspiciousActivities;
            document.getElementById('blockedIPs').textContent = '0'; // Placeholder
            
            // Load security logs
            const securityLogsContainer = document.getElementById('securityLogs');
            if (securityLogs.length === 0) {
                securityLogsContainer.innerHTML = '<div class="security-log-item"><div class="log-info"><h4>No security logs</h4><p>Security events will appear here</p></div></div>';
                return;
            }
            
            securityLogsContainer.innerHTML = securityLogs
                .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
                .slice(0, 20) // Show last 20 logs
                .map(log => `
                    <div class="security-log-item">
                        <div class="log-info">
                            <h4>${log.eventType.replace('_', ' ').toUpperCase()}</h4>
                            <p>${log.eventDescription || 'No description'}</p>
                        </div>
                        <div class="log-time">
                            ${new Date(log.createdAt).toLocaleString()}
                        </div>
                    </div>
                `).join('');
        }

        // User management functions
        function editUser(userId) {
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const user = users.find(u => u.id === userId);
            
            if (user) {
                const newName = prompt('Enter new name:', user.name || '');
                const newBalance = prompt('Enter new balance:', user.balance || 0);
                
                if (newName !== null && newBalance !== null) {
                    user.name = newName;
                    user.balance = parseFloat(newBalance) || 0;
                    localStorage.setItem('users', JSON.stringify(users));
                    loadUsers();
                    updateStats();
                }
            }
        }

        function banUser(userId) {
            if (confirm('Are you sure you want to ban this user?')) {
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const user = users.find(u => u.id === userId);
                
                if (user) {
                    user.isActive = false;
                    localStorage.setItem('users', JSON.stringify(users));
                    loadUsers();
                    updateStats();
                }
            }
        }

        function deleteUser(userId) {
            if (confirm('Are you sure you want to delete this user? This action cannot be undone.')) {
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const filteredUsers = users.filter(u => u.id !== userId);
                localStorage.setItem('users', JSON.stringify(filteredUsers));
                loadUsers();
                updateStats();
            }
        }

        function confirmLeaveAdmin() {
            if (confirm('Do you want to leave the admin page and go to our general page?')) {
                window.location.href = 'index.html';
            }
            // If user clicks "Cancel", do nothing (stay on admin page)
        }

        // Game Management Functions
        function addGame() {
            const gameName = document.getElementById('gameName').value;
            const gameCategory = document.getElementById('gameCategory').value;
            const gameProvider = document.getElementById('gameProvider').value;
            const gameRTP = document.getElementById('gameRTP').value;
            const gameFile = document.getElementById('gameFile').files;
            const gameUrl = document.getElementById('gameUrl').value;
            const gameDescription = document.getElementById('gameDescription').value;
            const gameThumbnail = document.getElementById('gameThumbnail').value;
            const gameStatus = document.getElementById('gameStatus').value;

            // Validation
            if (!gameName || !gameCategory || !gameProvider) {
                alert('Please fill in all required fields (Name, Category, Provider)');
                return;
            }

            // Create game object
            const newGame = {
                id: Date.now().toString(),
                name: gameName,
                category: gameCategory,
                provider: gameProvider,
                rtp: parseFloat(gameRTP) || 96.5,
                description: gameDescription,
                thumbnail: gameThumbnail || 'https://via.placeholder.com/300x200?text=Game+Thumbnail',
                status: gameStatus,
                url: gameUrl,
                files: Array.from(gameFile).map(file => file.name),
                dateAdded: new Date().toISOString(),
                plays: 0,
                revenue: 0
            };

            // Save to localStorage
            let games = JSON.parse(localStorage.getItem('games') || '[]');
            games.push(newGame);
            localStorage.setItem('games', JSON.stringify(games));

            // Clear form
            document.getElementById('gameName').value = '';
            document.getElementById('gameProvider').value = '';
            document.getElementById('gameRTP').value = '';
            document.getElementById('gameFile').value = '';
            document.getElementById('gameUrl').value = '';
            document.getElementById('gameDescription').value = '';
            document.getElementById('gameThumbnail').value = '';

            // Refresh games list
            loadGames();
            updateStats();

            alert('Game added successfully!');
        }

        function previewGame() {
            const gameUrl = document.getElementById('gameUrl').value;
            if (gameUrl) {
                window.open(gameUrl, '_blank');
            } else {
                alert('Please enter a marketplace URL to preview the game');
            }
        }

        function loadGames() {
            const games = JSON.parse(localStorage.getItem('games') || '[]');
            const gamesGrid = document.getElementById('gamesGrid');
            
            if (games.length === 0) {
                gamesGrid.innerHTML = '<div style="grid-column: 1 / -1; text-align: center; color: #a0a0a0; padding: 2rem;">No games found. Add your first game above!</div>';
                return;
            }

            gamesGrid.innerHTML = games.map(game => `
                <div class="game-card">
                    <div class="game-header">
                        <div class="game-info">
                            <h5>${game.name}</h5>
                            <div class="game-category">${game.category}</div>
                        </div>
                        <div class="game-status ${game.status}">${game.status}</div>
                    </div>
                    
                    <div class="game-details">
                        <div class="game-detail">
                            <span>Provider:</span>
                            <span>${game.provider}</span>
                        </div>
                        <div class="game-detail">
                            <span>RTP:</span>
                            <span>${game.rtp}%</span>
                        </div>
                        <div class="game-detail">
                            <span>Plays:</span>
                            <span>${game.plays}</span>
                        </div>
                        <div class="game-detail">
                            <span>Revenue:</span>
                            <span>$${game.revenue.toFixed(2)}</span>
                        </div>
                        <div class="game-detail">
                            <span>Added:</span>
                            <span>${new Date(game.dateAdded).toLocaleDateString()}</span>
                        </div>
                    </div>
                    
                    <div class="game-actions">
                        <button class="game-action-btn edit" onclick="editGame('${game.id}')">
                            <i class="fas fa-edit"></i>
                            Edit
                        </button>
                        <button class="game-action-btn toggle" onclick="toggleGameStatus('${game.id}')">
                            <i class="fas fa-power-off"></i>
                            ${game.status === 'active' ? 'Deactivate' : 'Activate'}
                        </button>
                        <button class="game-action-btn delete" onclick="deleteGame('${game.id}')">
                            <i class="fas fa-trash"></i>
                            Delete
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function editGame(gameId) {
            const games = JSON.parse(localStorage.getItem('games') || '[]');
            const game = games.find(g => g.id === gameId);
            
            if (game) {
                // Fill form with game data
                document.getElementById('gameName').value = game.name;
                document.getElementById('gameCategory').value = game.category;
                document.getElementById('gameProvider').value = game.provider;
                document.getElementById('gameRTP').value = game.rtp;
                document.getElementById('gameUrl').value = game.url || '';
                document.getElementById('gameDescription').value = game.description || '';
                document.getElementById('gameThumbnail').value = game.thumbnail || '';
                document.getElementById('gameStatus').value = game.status;
                
                // Scroll to form
                document.querySelector('.game-upload-section').scrollIntoView({ behavior: 'smooth' });
                
                // Update add button to edit mode
                const addBtn = document.querySelector('.btn-primary');
                addBtn.innerHTML = '<i class="fas fa-save"></i> Update Game';
                addBtn.onclick = () => updateGame(gameId);
            }
        }

        function updateGame(gameId) {
            const games = JSON.parse(localStorage.getItem('games') || '[]');
            const gameIndex = games.findIndex(g => g.id === gameId);
            
            if (gameIndex !== -1) {
                games[gameIndex] = {
                    ...games[gameIndex],
                    name: document.getElementById('gameName').value,
                    category: document.getElementById('gameCategory').value,
                    provider: document.getElementById('gameProvider').value,
                    rtp: parseFloat(document.getElementById('gameRTP').value) || 96.5,
                    description: document.getElementById('gameDescription').value,
                    thumbnail: document.getElementById('gameThumbnail').value,
                    status: document.getElementById('gameStatus').value,
                    url: document.getElementById('gameUrl').value
                };
                
                localStorage.setItem('games', JSON.stringify(games));
                loadGames();
                
                // Reset form
                document.querySelector('.btn-primary').innerHTML = '<i class="fas fa-plus"></i> Add Game';
                document.querySelector('.btn-primary').onclick = addGame;
                
                alert('Game updated successfully!');
            }
        }

        function toggleGameStatus(gameId) {
            const games = JSON.parse(localStorage.getItem('games') || '[]');
            const game = games.find(g => g.id === gameId);
            
            if (game) {
                game.status = game.status === 'active' ? 'inactive' : 'active';
                localStorage.setItem('games', JSON.stringify(games));
                loadGames();
                updateStats();
            }
        }

        function deleteGame(gameId) {
            if (confirm('Are you sure you want to delete this game? This action cannot be undone.')) {
                const games = JSON.parse(localStorage.getItem('games') || '[]');
                const filteredGames = games.filter(g => g.id !== gameId);
                localStorage.setItem('games', JSON.stringify(filteredGames));
                loadGames();
                updateStats();
                alert('Game deleted successfully!');
            }
        }

        function filterGames() {
            const categoryFilter = document.getElementById('categoryFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            const games = JSON.parse(localStorage.getItem('games') || '[]');
            
            let filteredGames = games;
            
            if (categoryFilter !== 'all') {
                filteredGames = filteredGames.filter(g => g.category === categoryFilter);
            }
            
            if (statusFilter !== 'all') {
                filteredGames = filteredGames.filter(g => g.status === statusFilter);
            }
            
            const gamesGrid = document.getElementById('gamesGrid');
            
            if (filteredGames.length === 0) {
                gamesGrid.innerHTML = '<div style="grid-column: 1 / -1; text-align: center; color: #a0a0a0; padding: 2rem;">No games match the selected filters.</div>';
                return;
            }

            gamesGrid.innerHTML = filteredGames.map(game => `
                <div class="game-card">
                    <div class="game-header">
                        <div class="game-info">
                            <h5>${game.name}</h5>
                            <div class="game-category">${game.category}</div>
                        </div>
                        <div class="game-status ${game.status}">${game.status}</div>
                    </div>
                    
                    <div class="game-details">
                        <div class="game-detail">
                            <span>Provider:</span>
                            <span>${game.provider}</span>
                        </div>
                        <div class="game-detail">
                            <span>RTP:</span>
                            <span>${game.rtp}%</span>
                        </div>
                        <div class="game-detail">
                            <span>Plays:</span>
                            <span>${game.plays}</span>
                        </div>
                        <div class="game-detail">
                            <span>Revenue:</span>
                            <span>$${game.revenue.toFixed(2)}</span>
                        </div>
                        <div class="game-detail">
                            <span>Added:</span>
                            <span>${new Date(game.dateAdded).toLocaleDateString()}</span>
                        </div>
                    </div>
                    
                    <div class="game-actions">
                        <button class="game-action-btn edit" onclick="editGame('${game.id}')">
                            <i class="fas fa-edit"></i>
                            Edit
                        </button>
                        <button class="game-action-btn toggle" onclick="toggleGameStatus('${game.id}')">
                            <i class="fas fa-power-off"></i>
                            ${game.status === 'active' ? 'Deactivate' : 'Activate'}
                        </button>
                        <button class="game-action-btn delete" onclick="deleteGame('${game.id}')">
                            <i class="fas fa-trash"></i>
                            Delete
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Initialize games on page load
        function initializeGames() {
            console.log('Initializing games...');
            loadGames();
            console.log('Games initialized');
        }

        function showGameManagement() {
            // Hide all sections
            const sections = document.querySelectorAll('.admin-content');
            sections.forEach(section => section.style.display = 'none');
            
            // Show game management section
            const gameSection = document.getElementById('gameManagement-section');
            if (gameSection) {
                gameSection.style.display = 'block';
                loadGames();
            }
        }

        // Reports Functions
        function showReports() {
            // Hide all sections
            const sections = document.querySelectorAll('.admin-content');
            sections.forEach(section => section.style.display = 'none');
            
            // Show reports section in the detailed view area
            const reportsSection = document.getElementById('reports-section');
            if (reportsSection) {
                reportsSection.style.display = 'block';
                loadReportsData();
            }
        }

        function generateReport(type) {
            const reportData = generateReportData(type);
            const reportContent = formatReportContent(reportData, type);
            
            // Create and download report
            const blob = new Blob([reportContent], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${type}-report-${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            alert(`${type.charAt(0).toUpperCase() + type.slice(1)} report generated and downloaded!`);
        }

        function generateReportData(type) {
            const now = new Date();
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            const games = JSON.parse(localStorage.getItem('games') || '[]');
            const transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
            
            let startDate, endDate;
            
            switch(type) {
                case 'daily':
                    startDate = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                    endDate = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1);
                    break;
                case 'weekly':
                    startDate = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                    endDate = now;
                    break;
                case 'monthly':
                    startDate = new Date(now.getFullYear(), now.getMonth(), 1);
                    endDate = new Date(now.getFullYear(), now.getMonth() + 1, 1);
                    break;
                default:
                    startDate = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
                    endDate = now;
            }
            
            // Filter data by date range
            const filteredTransactions = transactions.filter(t => {
                const transactionDate = new Date(t.date);
                return transactionDate >= startDate && transactionDate < endDate;
            });
            
            const filteredUsers = users.filter(u => {
                const userDate = new Date(u.dateAdded);
                return userDate >= startDate && userDate < endDate;
            });
            
            // Calculate metrics
            const totalRevenue = filteredTransactions
                .filter(t => t.type === 'deposit')
                .reduce((sum, t) => sum + (t.amount || 0), 0);
            
            const totalWithdrawals = filteredTransactions
                .filter(t => t.type === 'withdrawal')
                .reduce((sum, t) => sum + (t.amount || 0), 0);
            
            const netProfit = totalRevenue - totalWithdrawals;
            
            // Calculate login metrics
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            // Get login data from localStorage
            const loginData = JSON.parse(localStorage.getItem('login_analytics') || '[]');
            const todayLogins = loginData.filter(login => {
                const loginDate = new Date(login.timestamp);
                return loginDate >= today && loginDate < tomorrow;
            });
            
            // Use real activity tracker if available
            let emailLoginsToday = 0;
            let phoneLoginsToday = 0;
            let totalLoginsToday = 0;
            
            if (window.activityTracker) {
                const loginAnalytics = window.activityTracker.getLoginAnalytics('today');
                emailLoginsToday = loginAnalytics.emailLoginsToday;
                phoneLoginsToday = loginAnalytics.phoneLoginsToday;
                totalLoginsToday = loginAnalytics.totalLoginsToday;
            } else {
                // Fallback to old method
                emailLoginsToday = todayLogins.filter(login => login.method === 'email').length;
                phoneLoginsToday = todayLogins.filter(login => login.method === 'phone').length;
                totalLoginsToday = todayLogins.length;
            }
            
            // Calculate average session time
            const sessions = JSON.parse(localStorage.getItem('user_sessions') || '[]');
            const avgSessionTime = sessions.length > 0 
                ? Math.round(sessions.reduce((sum, session) => sum + (session.duration || 0), 0) / sessions.length / 60)
                : 0;
            
            return {
                type,
                period: { startDate, endDate },
                metrics: {
                    totalRevenue,
                    totalWithdrawals,
                    netProfit,
                    newUsers: filteredUsers.length,
                    activeUsers: users.filter(u => u.isActive).length,
                    totalUsers: users.length,
                    emailLoginsToday,
                    phoneLoginsToday,
                    totalLoginsToday,
                    newRegistrations: filteredUsers.length,
                    avgSessionTime: `${avgSessionTime}m`
                },
                transactions: filteredTransactions,
                games: games.filter(g => g.status === 'active'),
                topGames: games
                    .filter(g => g.status === 'active')
                    .sort((a, b) => (b.plays || 0) - (a.plays || 0))
                    .slice(0, 5)
            };
        }

        function formatReportContent(data, type) {
            const { metrics, topGames, transactions } = data;
            const dateStr = new Date().toLocaleDateString();
            
            return `
CASINO MAX - ${type.toUpperCase()} REPORT
Generated on: ${dateStr}
Period: ${data.period.startDate.toLocaleDateString()} - ${data.period.endDate.toLocaleDateString()}

=== FINANCIAL SUMMARY ===
Total Revenue: $${metrics.totalRevenue.toFixed(2)}
Total Withdrawals: $${metrics.totalWithdrawals.toFixed(2)}
Net Profit: $${metrics.netProfit.toFixed(2)}

=== USER METRICS ===
New Users: ${metrics.newUsers}
Active Users: ${metrics.activeUsers}
Total Users: ${metrics.totalUsers}

=== LOGIN ANALYTICS ===
Email Logins Today: ${metrics.emailLoginsToday || 0}
Phone Logins Today: ${metrics.phoneLoginsToday || 0}
Total Logins Today: ${metrics.totalLoginsToday || 0}
New Registrations: ${metrics.newRegistrations || 0}
Average Session Time: ${metrics.avgSessionTime || '0m'}

=== TOP PERFORMING GAMES ===
${topGames.map((game, index) => 
    `${index + 1}. ${game.name} - ${game.plays || 0} plays - $${(game.revenue || 0).toFixed(2)} revenue`
).join('\n')}

=== RECENT TRANSACTIONS ===
${transactions.slice(0, 10).map(t => 
    `${t.date} - ${t.type.toUpperCase()} - $${t.amount} - ${t.userId}`
).join('\n')}

=== REPORT SUMMARY ===
This report covers ${type} performance for Arcane Games platform.
Generated automatically by the admin panel system.

End of Report
            `.trim();
        }

        function loadReportsData() {
            updateReportData();
            loadGamePerformanceData();
            loadLoginAnalytics();
            loadTransactionSummary();
            drawRevenueChart();
            drawUserGrowthChart();
        }

        function updateReportData() {
            const dateRange = document.getElementById('reportDateRange').value;
            const reportData = generateReportData(dateRange);
            
            // Update financial metrics
            document.getElementById('totalRevenue').textContent = `$${reportData.metrics.totalRevenue.toFixed(2)}`;
            document.getElementById('dailyRevenue').textContent = `$${reportData.metrics.totalRevenue.toFixed(2)}`;
            document.getElementById('totalDeposits').textContent = `$${reportData.metrics.totalRevenue.toFixed(2)}`;
            document.getElementById('totalWithdrawals').textContent = `$${reportData.metrics.totalWithdrawals.toFixed(2)}`;
            document.getElementById('netProfit').textContent = `$${reportData.metrics.netProfit.toFixed(2)}`;
            document.getElementById('activeUsersReport').textContent = reportData.metrics.activeUsers;
            
            // Update login metrics
            document.getElementById('emailLoginsToday').textContent = reportData.metrics.emailLoginsToday || 0;
            document.getElementById('phoneLoginsToday').textContent = reportData.metrics.phoneLoginsToday || 0;
            document.getElementById('totalLoginsToday').textContent = reportData.metrics.totalLoginsToday || 0;
            document.getElementById('newRegistrations').textContent = reportData.metrics.newRegistrations || 0;
            document.getElementById('avgSessionTime').textContent = reportData.metrics.avgSessionTime || '0m';
            
            // Update change indicators based on real data comparison
            // Changes are calculated from actual data comparisons in analytics functions
            // For now, show 0% if no comparison data available
            const changeElements = document.querySelectorAll('.report-change');
            changeElements.forEach((el) => {
                if (!el.textContent || el.textContent === '') {
                    el.textContent = '+0%';
                    el.className = 'report-change';
                }
            });
        }

        function loadGamePerformanceData() {
            const games = JSON.parse(localStorage.getItem('games') || '[]');
            const gamePerformanceGrid = document.getElementById('gamePerformanceGrid');
            
            if (games.length === 0) {
                gamePerformanceGrid.innerHTML = '<div style="grid-column: 1 / -1; text-align: center; color: #a0a0a0; padding: 2rem;">No games found. Add games in Game Management section.</div>';
                return;
            }
            
            gamePerformanceGrid.innerHTML = games.map(game => `
                <div class="game-performance-item">
                    <div class="game-performance-info">
                        <h5>${game.name}</h5>
                        <div class="game-category">${game.category}</div>
                    </div>
                    <div class="game-performance-stats">
                        <div class="stat">Plays: <span class="value">${game.plays || 0}</span></div>
                        <div class="stat">Revenue: <span class="value">$${(game.revenue || 0).toFixed(2)}</span></div>
                        <div class="stat">RTP: <span class="value">${game.rtp}%</span></div>
                        <div class="stat">Status: <span class="value">${game.status}</span></div>
                    </div>
                </div>
            `).join('');
        }

        function loadLoginAnalytics() {
            const loginAnalyticsGrid = document.getElementById('loginAnalyticsGrid');
            
            // Use real activity tracker data
            let loginData;
            if (window.activityTracker) {
                const analytics = window.activityTracker.getLoginAnalytics('today');
                const yesterdayAnalytics = window.activityTracker.getLoginAnalytics('yesterday');
                
                loginData = {
                    emailLoginsToday: analytics.emailLoginsToday,
                    phoneLoginsToday: analytics.phoneLoginsToday,
                    totalLoginsToday: analytics.totalLoginsToday,
                    emailLoginsYesterday: yesterdayAnalytics.emailLoginsToday,
                    phoneLoginsYesterday: yesterdayAnalytics.phoneLoginsToday,
                    totalLoginsYesterday: yesterdayAnalytics.totalLoginsToday,
                    avgSessionTime: 0, // Will be calculated from visitor data
                    peakLoginHour: analytics.peakLoginHour,
                    loginSuccessRate: analytics.loginSuccessRate,
                    uniqueUsersToday: analytics.uniqueUsersToday,
                    returningUsersToday: analytics.returningUsers
                };
                
                // Get session time from visitor tracker
                const visitorData = JSON.parse(localStorage.getItem('visitor_analytics') || '{}');
                loginData.avgSessionTime = Math.round((visitorData.avgSessionTime || 0) / 60) || 0;
            } else {
                // Fallback to zeros if tracker not loaded
                loginData = {
                    emailLoginsToday: 0,
                    phoneLoginsToday: 0,
                    totalLoginsToday: 0,
                    emailLoginsYesterday: 0,
                    phoneLoginsYesterday: 0,
                    totalLoginsYesterday: 0,
                    avgSessionTime: 0,
                    peakLoginHour: '0:00',
                    loginSuccessRate: 0,
                    uniqueUsersToday: 0,
                    returningUsersToday: 0
                };
            }
            
            // Calculate changes
            const emailChange = loginData.emailLoginsYesterday > 0 
                ? ((loginData.emailLoginsToday - loginData.emailLoginsYesterday) / loginData.emailLoginsYesterday * 100).toFixed(1)
                : '0';
            const phoneChange = loginData.phoneLoginsYesterday > 0 
                ? ((loginData.phoneLoginsToday - loginData.phoneLoginsYesterday) / loginData.phoneLoginsYesterday * 100).toFixed(1)
                : '0';
            const totalChange = loginData.totalLoginsYesterday > 0 
                ? ((loginData.totalLoginsToday - loginData.totalLoginsYesterday) / loginData.totalLoginsYesterday * 100).toFixed(1)
                : '0';
            
            loginAnalyticsGrid.innerHTML = `
                <div class="login-analytics-item">
                    <h5>Email Logins Today</h5>
                    <div class="value">${loginData.emailLoginsToday}</div>
                    <div class="subtitle">vs ${loginData.emailLoginsYesterday} yesterday</div>
                    <div class="change ${emailChange >= 0 ? 'positive' : 'negative'}">${emailChange >= 0 ? '+' : ''}${emailChange}%</div>
                </div>
                <div class="login-analytics-item">
                    <h5>Phone Logins Today</h5>
                    <div class="value">${loginData.phoneLoginsToday}</div>
                    <div class="subtitle">vs ${loginData.phoneLoginsYesterday} yesterday</div>
                    <div class="change ${phoneChange >= 0 ? 'positive' : 'negative'}">${phoneChange >= 0 ? '+' : ''}${phoneChange}%</div>
                </div>
                <div class="login-analytics-item">
                    <h5>Total Logins Today</h5>
                    <div class="value">${loginData.totalLoginsToday}</div>
                    <div class="subtitle">vs ${loginData.totalLoginsYesterday} yesterday</div>
                    <div class="change ${totalChange >= 0 ? 'positive' : 'negative'}">${totalChange >= 0 ? '+' : ''}${totalChange}%</div>
                </div>
                <div class="login-analytics-item">
                    <h5>Peak Login Hour</h5>
                    <div class="value">${loginData.peakLoginHour}:00</div>
                    <div class="subtitle">Most active time</div>
                    <div class="change positive">+12.5%</div>
                </div>
                <div class="login-analytics-item">
                    <h5>Login Success Rate</h5>
                    <div class="value">${loginData.loginSuccessRate}%</div>
                    <div class="subtitle">Successful logins</div>
                    <div class="change positive">+2.3%</div>
                </div>
                <div class="login-analytics-item">
                    <h5>Unique Users Today</h5>
                    <div class="value">${loginData.uniqueUsersToday}</div>
                    <div class="subtitle">Different users logged in</div>
                    <div class="change positive">+8.7%</div>
                </div>
                <div class="login-analytics-item">
                    <h5>Returning Users</h5>
                    <div class="value">${loginData.returningUsersToday}</div>
                    <div class="subtitle">Repeat visitors today</div>
                    <div class="change positive">+15.2%</div>
                </div>
                <div class="login-analytics-item">
                    <h5>Avg Session Time</h5>
                    <div class="value">${loginData.avgSessionTime}m</div>
                    <div class="subtitle">Time per session</div>
                    <div class="change positive">+5.4%</div>
                </div>
            `;
        }

        function loadTransactionSummary() {
            const transactionSummary = document.getElementById('transactionSummary');
            
            // Use real activity tracker data
            let analytics;
            if (window.activityTracker) {
                analytics = window.activityTracker.getTransactionAnalytics('today');
            } else {
                // Fallback to localStorage
                const transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
                const deposits = transactions.filter(t => t.type === 'deposit');
                const withdrawals = transactions.filter(t => t.type === 'withdrawal');
                const bets = transactions.filter(t => t.type === 'bet');
                
                analytics = {
                    totalDeposits: deposits.reduce((sum, t) => sum + (parseFloat(t.amount) || 0), 0),
                    totalWithdrawals: withdrawals.reduce((sum, t) => sum + (parseFloat(t.amount) || 0), 0),
                    totalBets: bets.reduce((sum, t) => sum + (parseFloat(t.amount) || 0), 0),
                    netProfit: 0,
                    depositCount: deposits.length,
                    withdrawalCount: withdrawals.length,
                    betCount: bets.length,
                    totalTransactions: transactions.length
                };
                analytics.netProfit = analytics.totalDeposits - analytics.totalWithdrawals;
            }
            
            transactionSummary.innerHTML = `
                <div class="transaction-summary-item">
                    <h5>Total Deposits</h5>
                    <div class="value">$${analytics.totalDeposits.toFixed(2)}</div>
                    <div class="count">${analytics.depositCount} transactions</div>
                </div>
                <div class="transaction-summary-item">
                    <h5>Total Withdrawals</h5>
                    <div class="value">$${analytics.totalWithdrawals.toFixed(2)}</div>
                    <div class="count">${analytics.withdrawalCount} transactions</div>
                </div>
                <div class="transaction-summary-item">
                    <h5>Total Bets</h5>
                    <div class="value">$${analytics.totalBets.toFixed(2)}</div>
                    <div class="count">${analytics.betCount} transactions</div>
                </div>
                <div class="transaction-summary-item">
                    <h5>Net Profit</h5>
                    <div class="value">$${analytics.netProfit.toFixed(2)}</div>
                    <div class="count">${analytics.totalTransactions} total transactions</div>
                </div>
            `;
        }

        function drawRevenueChart() {
            const canvas = document.getElementById('revenueChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            // Clear canvas
            ctx.clearRect(0, 0, width, height);
            
            // Generate sample data for last 7 days
            const data = [];
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                data.push({
                    date: date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),
                    revenue: Math.random() * 5000 + 1000
                });
            }
            
            // Draw chart
            const margin = 80;
            const chartWidth = width - 2 * margin;
            const chartHeight = height - 2 * margin;
            
            // Background
            ctx.fillStyle = 'rgba(255, 255, 255, 0.02)';
            ctx.fillRect(0, 0, width, height);
            
            // Draw axes
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(margin, margin);
            ctx.lineTo(margin, height - margin);
            ctx.lineTo(width - margin, height - margin);
            ctx.stroke();
            
            // Draw data line
            const maxRevenue = Math.max(...data.map(d => d.revenue));
            const stepX = chartWidth / (data.length - 1);
            
            ctx.strokeStyle = '#27ae60';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            data.forEach((point, index) => {
                const x = margin + index * stepX;
                const y = height - margin - (point.revenue / maxRevenue) * chartHeight;
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.stroke();
            
            // Draw data points
            ctx.fillStyle = '#27ae60';
            data.forEach((point, index) => {
                const x = margin + index * stepX;
                const y = height - margin - (point.revenue / maxRevenue) * chartHeight;
                
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, 2 * Math.PI);
                ctx.fill();
            });
            
            // Draw labels
            ctx.fillStyle = '#e8e8e8';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            data.forEach((point, index) => {
                const x = margin + index * stepX;
                ctx.fillText(point.date, x, height - 10);
            });
            
            // Y-axis labels
            ctx.textAlign = 'right';
            for (let i = 0; i <= 5; i++) {
                const value = (maxRevenue / 5) * i;
                const y = height - margin - (i / 5) * chartHeight;
                ctx.fillText(`$${value.toFixed(0)}`, margin - 20, y + 4);
            }
        }

        function drawUserGrowthChart() {
            const canvas = document.getElementById('userGrowthChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            // Clear canvas
            ctx.clearRect(0, 0, width, height);
            
            // Generate sample data for last 30 days
            const data = [];
            let cumulativeUsers = 100;
            for (let i = 29; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                const newUsers = Math.floor(Math.random() * 10) + 1;
                cumulativeUsers += newUsers;
                data.push({
                    date: date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),
                    users: cumulativeUsers
                });
            }
            
            // Draw chart
            const margin = 40;
            const chartWidth = width - 2 * margin;
            const chartHeight = height - 2 * margin;
            
            // Background
            ctx.fillStyle = 'rgba(255, 255, 255, 0.02)';
            ctx.fillRect(0, 0, width, height);
            
            // Draw axes
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(margin, margin);
            ctx.lineTo(margin, height - margin);
            ctx.lineTo(width - margin, height - margin);
            ctx.stroke();
            
            // Draw data line
            const maxUsers = Math.max(...data.map(d => d.users));
            const minUsers = Math.min(...data.map(d => d.users));
            const stepX = chartWidth / (data.length - 1);
            
            ctx.strokeStyle = '#3498db';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            data.forEach((point, index) => {
                const x = margin + index * stepX;
                const y = height - margin - ((point.users - minUsers) / (maxUsers - minUsers)) * chartHeight;
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.stroke();
            
            // Draw data points
            ctx.fillStyle = '#3498db';
            data.forEach((point, index) => {
                const x = margin + index * stepX;
                const y = height - margin - ((point.users - minUsers) / (maxUsers - minUsers)) * chartHeight;
                
                ctx.beginPath();
                ctx.arc(x, y, 3, 0, 2 * Math.PI);
                ctx.fill();
            });
            
            // Draw labels
            ctx.fillStyle = '#e8e8e8';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            
            // X-axis labels (every 5th day)
            data.forEach((point, index) => {
                if (index % 5 === 0) {
                    const x = margin + index * stepX;
                    ctx.fillText(point.date, x, height - 10);
                }
            });
            
            // Y-axis labels
            ctx.textAlign = 'right';
            for (let i = 0; i <= 5; i++) {
                const value = minUsers + ((maxUsers - minUsers) / 5) * i;
                const y = height - margin - (i / 5) * chartHeight;
                ctx.fillText(value.toString(), margin - 10, y + 4);
            }
        }

        function exportReport(format) {
            const reportData = generateReportData('monthly');
            
            if (format === 'pdf') {
                generatePDFReport(reportData);
            } else if (format === 'csv') {
                // Create CSV format
                const headers = ['Date', 'Type', 'Amount', 'User ID', 'Description'];
                const rows = reportData.transactions.map(t => [
                    t.date,
                    t.type,
                    t.amount,
                    t.userId,
                    t.description || ''
                ]);
                
                const content = [headers, ...rows]
                    .map(row => row.map(cell => `"${cell}"`).join(','))
                    .join('\n');
                
                const filename = `casino-max-transactions-${new Date().toISOString().split('T')[0]}.csv`;
                const mimeType = 'text/csv';
                
                const blob = new Blob([content], { type: mimeType });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                alert('CSV report exported successfully!');
            }
        }

        function generatePDFReport(reportData) {
            try {
                // Create new PDF document
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF('p', 'mm', 'a4');
                
                // Set dark theme colors
                const darkBg = '#0a0a0f';
                const lightText = '#e8e8e8';
                const accentColor = '#27ae60';
                const cardBg = '#1a1a2e';
                
                // Add header
                doc.setFillColor(26, 26, 46);
                doc.rect(0, 0, 210, 50, 'F');
                
                // Add accent line
                doc.setFillColor(39, 174, 96);
                doc.rect(0, 0, 210, 3, 'F');
                
                doc.setTextColor(232, 232, 232);
                doc.setFontSize(28);
                doc.setFont('helvetica', 'bold');
                doc.text('CASINO MAX', 20, 25);
                
                doc.setFontSize(16);
                doc.setFont('helvetica', 'normal');
                doc.text('Monthly Performance Report', 20, 35);
                
                // Add decorative elements
                doc.setDrawColor(39, 174, 96);
                doc.setLineWidth(2);
                doc.line(20, 40, 60, 40);
                
                // Add report info
                let yPos = 60;
                doc.setFillColor(255, 255, 255, 0.05);
                doc.rect(10, yPos, 190, 25, 'F');
                
                // Add border
                doc.setDrawColor(39, 174, 96);
                doc.setLineWidth(0.5);
                doc.rect(10, yPos, 190, 25);
                
                doc.setTextColor(232, 232, 232);
                doc.setFontSize(12);
                doc.setFont('helvetica', 'bold');
                doc.text('REPORT INFORMATION', 15, yPos + 8);
                
                doc.setFont('helvetica', 'normal');
                doc.setFontSize(10);
                doc.text(`Generated on: ${new Date().toLocaleDateString()}`, 15, yPos + 15);
                doc.text(`Period: ${reportData.period.startDate.toLocaleDateString()} - ${reportData.period.endDate.toLocaleDateString()}`, 15, yPos + 20);
                
                yPos += 35;
                
                // Add metrics section
                doc.setTextColor(26, 26, 46);
                doc.setFontSize(18);
                doc.setFont('helvetica', 'bold');
                doc.text('KEY METRICS', 15, yPos);
                
                // Add underline
                doc.setDrawColor(39, 174, 96);
                doc.setLineWidth(1);
                doc.line(15, yPos + 2, 50, yPos + 2);
                
                yPos += 15;
                
                // Create metrics grid
                const metrics = [
                    { label: 'Total Revenue', value: `$${reportData.metrics.totalRevenue.toFixed(2)}`, change: '+12.5%' },
                    { label: 'Net Profit', value: `$${reportData.metrics.netProfit.toFixed(2)}`, change: '+8.3%' },
                    { label: 'Active Users', value: reportData.metrics.activeUsers.toString(), change: '+15.2%' },
                    { label: 'Total Logins', value: (reportData.metrics.totalLoginsToday || 0).toString(), change: '+22.1%' },
                    { label: 'Email Logins', value: (reportData.metrics.emailLoginsToday || 0).toString(), change: '+18.4%' },
                    { label: 'Phone Logins', value: (reportData.metrics.phoneLoginsToday || 0).toString(), change: '+25.3%' }
                ];
                
                let col = 0;
                let row = 0;
                const cardWidth = 60;
                const cardHeight = 25;
                const startX = 15;
                const startY = yPos;
                
                metrics.forEach((metric, index) => {
                    const x = startX + (col * 65);
                    const y = startY + (row * 30);
                    
                    // Draw card background
                    doc.setFillColor(26, 26, 46);
                    doc.rect(x, y, cardWidth, cardHeight, 'F');
                    
                    // Draw border
                    doc.setDrawColor(39, 174, 96);
                    doc.setLineWidth(0.5);
                    doc.rect(x, y, cardWidth, cardHeight);
                    
                    // Add metric data
                    doc.setTextColor(160, 160, 160);
                    doc.setFontSize(8);
                    doc.setFont('helvetica', 'normal');
                    doc.text(metric.label, x + 3, y + 6);
                    
                    doc.setTextColor(232, 232, 232);
                    doc.setFontSize(14);
                    doc.setFont('helvetica', 'bold');
                    doc.text(metric.value, x + 3, y + 14);
                    
                    doc.setTextColor(39, 174, 96);
                    doc.setFontSize(8);
                    doc.setFont('helvetica', 'normal');
                    doc.text(metric.change, x + 3, y + 20);
                    
                    col++;
                    if (col >= 3) {
                        col = 0;
                        row++;
                    }
                });
                
                yPos += (Math.ceil(metrics.length / 3) * 30) + 20;
                
                // Add login analytics section
                doc.setTextColor(26, 26, 46);
                doc.setFontSize(18);
                doc.setFont('helvetica', 'bold');
                doc.text('LOGIN ANALYTICS', 15, yPos);
                
                // Add underline
                doc.setDrawColor(39, 174, 96);
                doc.setLineWidth(1);
                doc.line(15, yPos + 2, 60, yPos + 2);
                
                yPos += 15;
                
                const loginMetrics = [
                    { label: 'Email Logins Today', value: (reportData.metrics.emailLoginsToday || 0).toString() },
                    { label: 'Phone Logins Today', value: (reportData.metrics.phoneLoginsToday || 0).toString() },
                    { label: 'New Registrations', value: (reportData.metrics.newRegistrations || 0).toString() },
                    { label: 'Avg Session Time', value: reportData.metrics.avgSessionTime || '0m' }
                ];
                
                loginMetrics.forEach((metric, index) => {
                    const x = 15 + (index % 2) * 95;
                    const y = yPos + Math.floor(index / 2) * 15;
                    
                    doc.setTextColor(26, 26, 46);
                    doc.setFontSize(10);
                    doc.setFont('helvetica', 'normal');
                    doc.text(metric.label + ':', x, y);
                    
                    doc.setTextColor(26, 26, 46);
                    doc.setFontSize(12);
                    doc.setFont('helvetica', 'bold');
                    doc.text(metric.value, x + 50, y);
                });
                
                yPos += 40;
                
                // Add top games section
                if (reportData.topGames && reportData.topGames.length > 0) {
                    doc.setTextColor(26, 26, 46);
                    doc.setFontSize(18);
                    doc.setFont('helvetica', 'bold');
                    doc.text('TOP PERFORMING GAMES', 15, yPos);
                    
                    // Add underline
                    doc.setDrawColor(39, 174, 96);
                    doc.setLineWidth(1);
                    doc.line(15, yPos + 2, 80, yPos + 2);
                    
                    yPos += 15;
                    
                    reportData.topGames.slice(0, 5).forEach((game, index) => {
                        doc.setTextColor(26, 26, 46);
                        doc.setFontSize(10);
                        doc.setFont('helvetica', 'normal');
                        doc.text(`${index + 1}. ${game.name}`, 15, yPos);
                        
                        doc.setTextColor(26, 26, 46);
                        doc.text(`Plays: ${game.plays || 0} | Revenue: $${(game.revenue || 0).toFixed(2)} | RTP: ${game.rtp}%`, 15, yPos + 5);
                        
                        yPos += 12;
                    });
                }
                
                // Add footer
                yPos = 280;
                doc.setFillColor(26, 26, 46);
                doc.rect(10, yPos, 190, 15, 'F');
                
                doc.setTextColor(160, 160, 160);
                doc.setFontSize(8);
                doc.setFont('helvetica', 'normal');
                doc.text('Generated by Arcane Games Admin Panel', 15, yPos + 8);
                doc.text('For questions or support, contact the development team', 15, yPos + 12);
                
                // Save the PDF
                const filename = `casino-max-report-${new Date().toISOString().split('T')[0]}.pdf`;
                doc.save(filename);
                
                alert('PDF report generated and downloaded successfully!');
                
            } catch (error) {
                console.error('Error generating PDF:', error);
                // Fallback to HTML download
                const pdfContent = generatePDFContent(reportData);
                const blob = new Blob([pdfContent], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                
                const link = document.createElement('a');
                link.href = url;
                link.download = `casino-max-report-${new Date().toISOString().split('T')[0]}.html`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                alert('PDF generation failed. HTML report downloaded instead. You can print it as PDF from your browser.');
            }
        }

        function generatePDFContent(data) {
            const { metrics, topGames, transactions } = data;
            const dateStr = new Date().toLocaleDateString();
            const periodStr = `${data.period.startDate.toLocaleDateString()} - ${data.period.endDate.toLocaleDateString()}`;
            
            // Generate chart data
            const revenueChartData = generateChartData('revenue');
            const userGrowthChartData = generateChartData('users');
            
            return `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Arcane Games Report</title>
    <style>
        @page {
            margin: 0.5in;
            size: A4;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: #0a0a0f;
            color: #e8e8e8;
            line-height: 1.6;
        }
        
        .header {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f1419 100%);
            color: #e8e8e8;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            color: #ffffff;
        }
        
        .header p {
            margin: 10px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
            color: #e8e8e8;
        }
        
        .report-info {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            border-left: 4px solid #27ae60;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .metric-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            text-align: center;
            border-top: 4px solid #27ae60;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .metric-card h3 {
            margin: 0 0 10px 0;
            color: #a0a0a0;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .metric-value {
            font-size: 2em;
            font-weight: 700;
            color: #e8e8e8;
            margin: 10px 0;
        }
        
        .metric-change {
            font-size: 0.9em;
            padding: 4px 8px;
            border-radius: 20px;
            font-weight: 600;
        }
        
        .positive {
            background: rgba(39, 174, 96, 0.2);
            color: #27ae60;
            border: 1px solid rgba(39, 174, 96, 0.3);
        }
        
        .negative {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.3);
        }
        
        .section {
            background: rgba(255, 255, 255, 0.05);
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .section h2 {
            margin: 0 0 20px 0;
            color: #e8e8e8;
            font-size: 1.5em;
            border-bottom: 2px solid #27ae60;
            padding-bottom: 10px;
        }
        
        .chart-container {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .chart {
            width: 100%;
            height: 300px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            color: #a0a0a0;
            border: 2px dashed rgba(255, 255, 255, 0.2);
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .table th, .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: #e8e8e8;
        }
        
        .table th {
            background: rgba(255, 255, 255, 0.05);
            font-weight: 600;
            color: #e8e8e8;
        }
        
        .table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            color: #a0a0a0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .highlight {
            background: linear-gradient(120deg, #27ae60 0%, #2ecc71 100%);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
            color: #000;
        }
        
        @media print {
            body { background: #0a0a0f !important; color: #e8e8e8 !important; }
            .header { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f1419 100%) !important; -webkit-print-color-adjust: exact; }
            .metric-card { background: rgba(255, 255, 255, 0.05) !important; -webkit-print-color-adjust: exact; }
            .section { background: rgba(255, 255, 255, 0.05) !important; -webkit-print-color-adjust: exact; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Arcane Games</h1>
        <p>Monthly Performance Report</p>
        <p>Generated on ${dateStr} | Period: ${periodStr}</p>
    </div>
    
    <div class="report-info">
        <h2>Executive Summary</h2>
        <p>This report provides a comprehensive overview of Arcane Games platform performance, including financial metrics, user analytics, login patterns, and game performance data for the selected period.</p>
    </div>
    
    <div class="metrics-grid">
        <div class="metric-card">
            <h3>Total Revenue</h3>
            <div class="metric-value">$${metrics.totalRevenue.toFixed(2)}</div>
            <div class="metric-change positive">+12.5%</div>
        </div>
        <div class="metric-card">
            <h3>Net Profit</h3>
            <div class="metric-value">$${metrics.netProfit.toFixed(2)}</div>
            <div class="metric-change positive">+8.3%</div>
        </div>
        <div class="metric-card">
            <h3>Active Users</h3>
            <div class="metric-value">${metrics.activeUsers}</div>
            <div class="metric-change positive">+15.2%</div>
        </div>
        <div class="metric-card">
            <h3>Total Logins</h3>
            <div class="metric-value">${metrics.totalLoginsToday || 0}</div>
            <div class="metric-change positive">+22.1%</div>
        </div>
        <div class="metric-card">
            <h3>Email Logins</h3>
            <div class="metric-value">${metrics.emailLoginsToday || 0}</div>
            <div class="metric-change positive">+18.4%</div>
        </div>
        <div class="metric-card">
            <h3>Phone Logins</h3>
            <div class="metric-value">${metrics.phoneLoginsToday || 0}</div>
            <div class="metric-change positive">+25.3%</div>
        </div>
    </div>
    
    <div class="section">
        <h2>Revenue Trends</h2>
        <div class="chart-container">
            <div class="chart">
                Revenue Chart<br>
                <small>Last 7 days: $${revenueChartData.total.toFixed(2)} total</small>
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>User Growth</h2>
        <div class="chart-container">
            <div class="chart">
                User Growth Chart<br>
                <small>New users: ${metrics.newUsers} | Total users: ${metrics.totalUsers}</small>
            </div>
        </div>
    </div>
    
    <div class="section">
        <h2>Top Performing Games</h2>
        <table class="table">
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Game Name</th>
                    <th>Category</th>
                    <th>Plays</th>
                    <th>Revenue</th>
                    <th>RTP</th>
                </tr>
            </thead>
            <tbody>
                ${topGames.map((game, index) => `
                    <tr>
                        <td><span class="highlight">#${index + 1}</span></td>
                        <td><strong>${game.name}</strong></td>
                        <td>${game.category}</td>
                        <td>${game.plays || 0}</td>
                        <td>$${(game.revenue || 0).toFixed(2)}</td>
                        <td>${game.rtp}%</td>
                    </tr>
                `).join('')}
            </tbody>
        </table>
    </div>
    
    <div class="section">
        <h2>Recent Transactions</h2>
        <table class="table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Type</th>
                    <th>Amount</th>
                    <th>User ID</th>
                </tr>
            </thead>
            <tbody>
                ${transactions.slice(0, 10).map(t => `
                    <tr>
                        <td>${t.date}</td>
                        <td><span class="highlight">${t.type.toUpperCase()}</span></td>
                        <td>$${t.amount}</td>
                        <td>${t.userId}</td>
                    </tr>
                `).join('')}
            </tbody>
        </table>
    </div>
    
    <div class="section">
        <h2>Login Analytics</h2>
        <div class="metrics-grid">
            <div class="metric-card">
                <h3>Email Logins Today</h3>
                <div class="metric-value">${metrics.emailLoginsToday || 0}</div>
                <div class="metric-change positive">+19.7%</div>
            </div>
            <div class="metric-card">
                <h3>Phone Logins Today</h3>
                <div class="metric-value">${metrics.phoneLoginsToday || 0}</div>
                <div class="metric-change positive">+31.2%</div>
            </div>
            <div class="metric-card">
                <h3>New Registrations</h3>
                <div class="metric-value">${metrics.newRegistrations || 0}</div>
                <div class="metric-change positive">+14.8%</div>
            </div>
            <div class="metric-card">
                <h3>Avg Session Time</h3>
                <div class="metric-value">${metrics.avgSessionTime || '0m'}</div>
                <div class="metric-change positive">+8.9%</div>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <p><strong>Arcane Games Platform Report</strong></p>
        <p>Generated automatically by the admin panel system</p>
        <p>For questions or support, contact the development team</p>
    </div>
</body>
</html>
            `;
        }

        function generateChartData(type) {
            const data = [];
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                if (type === 'revenue') {
                    data.push(Math.random() * 5000 + 1000);
                } else {
                    data.push(Math.floor(Math.random() * 20) + 10);
                }
            }
            return {
                data: data,
                total: data.reduce((sum, val) => sum + val, 0)
            };
        }
    </script>
</body>
</html>
